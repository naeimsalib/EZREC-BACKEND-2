Before running deployment script again

michomanoly14892@raspberrypi:~ $ # Test the API endpoints
curl -s http://localhost:8000/test-alive
curl -s http://localhost:8000/status

# Check if all services are running
sudo systemctl status ezrec-api.service
sudo systemctl status dual_recorder.service
sudo systemctl status video_worker.service
sudo systemctl status system_status.service
â— ezrec-api.service - EZREC FastAPI Backendstamp":"2025-08-31T00:44:23.645904","version":"1.0.0"}
     Loaded: loaded (/etc/systemd/system/ezrec-api.service; enabled; preset: enabled)
     Active: active (running) since Sun 2025-08-31 00:42:58 EDT; 1min 25s ago
   Main PID: 570317 (uvicorn)
      Tasks: 10 (limit: 9572)
        CPU: 1.269s
     CGroup: /system.slice/ezrec-api.service
             â””â”€570317 /opt/ezrec-backend/api/venv/bin/python3 /opt/ezrec-backend/api/venv/bin/uvicorn api_server:app --host 0.0.0.0 --port 8000

Aug 31 00:42:58 raspberrypi systemd[1]: Started ezrec-api.service - EZREC FastAPI Backend.
Aug 31 00:42:59 raspberrypi uvicorn[570317]: 2025-08-31 00:42:59,108 [INFO] âœ… Supabase client initialized successfully
Aug 31 00:42:59 raspberrypi uvicorn[570317]: 2025-08-31 00:42:59,109 [INFO] âœ… Using camera ID: d217e751-dfa5-5276-abbb-da5ad6c2626a
Aug 31 00:42:59 raspberrypi uvicorn[570317]: INFO:     Started server process [570317]
Aug 31 00:42:59 raspberrypi uvicorn[570317]: INFO:     Waiting for application startup.
Aug 31 00:42:59 raspberrypi uvicorn[570317]: INFO:     Application startup complete.
Aug 31 00:42:59 raspberrypi uvicorn[570317]: INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
Aug 31 00:44:23 raspberrypi uvicorn[570317]: INFO:     127.0.0.1:45724 - "GET /test-alive HTTP/1.1" 200 OK
Aug 31 00:44:23 raspberrypi uvicorn[570317]: INFO:     127.0.0.1:45726 - "GET /status HTTP/1.1" 200 OK
â— dual_recorder.service - EZREC Dual Camera Recorder Service
     Loaded: loaded (/etc/systemd/system/dual_recorder.service; enabled; preset: enabled)
     Active: active (running) since Sun 2025-08-31 00:38:11 EDT; 6min ago
   Main PID: 569414 (python3)
      Tasks: 6 (limit: 9572)
        CPU: 1.398s
     CGroup: /system.slice/dual_recorder.service
             â””â”€569414 /opt/ezrec-backend/backend/venv/bin/python3 /opt/ezrec-backend/backend/dual_recorder.py

Aug 31 00:44:18 raspberrypi python3[569414]: 2025-08-31 00:44:18,436 - INFO - ğŸ“‹ Loaded 0 bookings from cache
Aug 31 00:44:18 raspberrypi python3[569414]: 2025-08-31 00:44:18,436 - INFO - ğŸ” Checking 0 bookings at 2025-08-31 00:44:18 EDT
Aug 31 00:44:18 raspberrypi python3[569414]: 2025-08-31 00:44:18,436 - INFO - ğŸ” Looking for user_id: 65aa2e2a-e463-424d-b88f-0724bb0bea3a, camera_id: d217e751-dfa5-5276-abbb-da5ad6c2626a
Aug 31 00:44:18 raspberrypi python3[569414]: 2025-08-31 00:44:18,436 - INFO - âŒ No active booking found
Aug 31 00:44:18 raspberrypi python3[569414]: 2025-08-31 00:44:18,436 - INFO - â³ No active booking found, waiting...
Aug 31 00:44:23 raspberrypi python3[569414]: 2025-08-31 00:44:23,437 - INFO - ğŸ“‹ Loaded 0 bookings from cache
Aug 31 00:44:23 raspberrypi python3[569414]: 2025-08-31 00:44:23,437 - INFO - ğŸ” Checking 0 bookings at 2025-08-31 00:44:23 EDT
Aug 31 00:44:23 raspberrypi python3[569414]: 2025-08-31 00:44:23,437 - INFO - ğŸ” Looking for user_id: 65aa2e2a-e463-424d-b88f-0724bb0bea3a, camera_id: d217e751-dfa5-5276-abbb-da5ad6c2626a
Aug 31 00:44:23 raspberrypi python3[569414]: 2025-08-31 00:44:23,437 - INFO - âŒ No active booking found
Aug 31 00:44:23 raspberrypi python3[569414]: 2025-08-31 00:44:23,437 - INFO - â³ No active booking found, waiting...
â— video_worker.service - EZREC Video Processing Worker Service
     Loaded: loaded (/etc/systemd/system/video_worker.service; enabled; preset: enabled)
     Active: active (running) since Sun 2025-08-31 00:38:03 EDT; 6min ago
   Main PID: 568995 (python3)
      Tasks: 1 (limit: 9572)
        CPU: 875ms
     CGroup: /system.slice/video_worker.service
             â””â”€568995 /opt/ezrec-backend/backend/venv/bin/python3 /opt/ezrec-backend/backend/video_worker.py

Aug 31 00:42:05 raspberrypi python3[568995]: 2025-08-31 00:42:05,214 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:42:20 raspberrypi python3[568995]: 2025-08-31 00:42:20,241 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:42:35 raspberrypi python3[568995]: 2025-08-31 00:42:35,280 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:42:50 raspberrypi python3[568995]: 2025-08-31 00:42:50,318 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:43:05 raspberrypi python3[568995]: 2025-08-31 00:43:05,352 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:43:20 raspberrypi python3[568995]: 2025-08-31 00:43:20,412 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:43:35 raspberrypi python3[568995]: 2025-08-31 00:43:35,443 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:43:50 raspberrypi python3[568995]: 2025-08-31 00:43:50,471 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:44:05 raspberrypi python3[568995]: 2025-08-31 00:44:05,502 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:44:20 raspberrypi python3[568995]: 2025-08-31 00:44:20,531 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
â— system_status.service - EZREC System Status Monitor
     Loaded: loaded (/etc/systemd/system/system_status.service; enabled; preset: enabled)
     Active: active (exited) since Sun 2025-08-31 00:37:53 EDT; 6min ago
TriggeredBy: â— system_status.timer
   Main PID: 568916 (code=exited, status=0/SUCCESS)
        CPU: 1.065s

Aug 31 00:37:53 raspberrypi python3[568916]: [77:49:10.811708178] [568939] ERROR RPI pisp.cpp:947 Failed to register camera imx477 11-001a: -22
Aug 31 00:37:53 raspberrypi python3[568916]: 2025-08-31 00:37:53,115 [INFO] Initialization successful.
Aug 31 00:37:53 raspberrypi python3[568916]: 2025-08-31 00:37:53,115 [INFO] Camera now open.
Aug 31 00:37:53 raspberrypi python3[568916]: 2025-08-31 00:37:53,316 [INFO] Camera closed successfully.
Aug 31 00:37:53 raspberrypi python3[568916]: 2025-08-31 00:37:53,492 [INFO] ğŸ“Š Overall Status: CRITICAL
Aug 31 00:37:53 raspberrypi python3[568916]: 2025-08-31 00:37:53,492 [ERROR] ğŸš¨ Critical Issues: Inactive services: ezrec-api.service
Aug 31 00:37:53 raspberrypi python3[568916]: 2025-08-31 00:37:53,493 [INFO] âœ… Status saved to /opt/ezrec-backend/status.json
Aug 31 00:37:53 raspberrypi python3[568916]: 2025-08-31 00:37:53,493 [INFO] âœ… Health check completed successfully
Aug 31 00:37:53 raspberrypi python3[568916]: 2025-08-31 00:37:53,494 [INFO] âœ… System Status: critical
Aug 31 00:37:53 raspberrypi systemd[1]: Finished system_status.service - EZREC System Status Monitor.
michomanoly14892@raspberrypi:~ $ 

after running the deployment script again

michomanoly14892@raspberrypi:~ $ # Go back to your project directory
cd ~/EZREC-BACKEND-2

# Now run the deployment script again - it should complete successfully this time!
sudo ./deployment.sh
[00:45:05] Starting EZREC deployment as user: root
[00:45:05] STEP: 1. Stopping old services
[00:45:05] Managing dual_recorder: stop
[00:45:12] Managing video_worker: stop
[00:45:12] Managing ezrec-api: stop
[00:45:13] Managing system_status: stop
[00:45:13] Managing dual_recorder: disable
[00:45:13] Managing video_worker: disable
[00:45:13] Managing ezrec-api: disable
[00:45:13] Managing system_status: disable
[00:45:14] STEP: 2. Cleaning up old installation
[00:45:14] ğŸ”’ Backing up existing .env file
[00:45:14] âœ… .env file backed up successfully
[00:45:14] ğŸ§¹ Cleaning up old installation (preserving .env)...
[00:45:14] ğŸ”’ .env file found - will preserve it during cleanup
[00:45:14] âœ… Cleaned up old files (preserved .env)
[00:45:14] âœ… .env file successfully preserved
[00:45:14] STEP: 3. Copying project files
[00:45:14] ğŸ”’ Restoring .env file
[00:45:14] âœ… .env file restored successfully
[00:45:14] ğŸ”§ Ensuring required environment variables are present...
[00:45:14] âœ… All required environment variables are present
[00:45:14] ğŸ”§ Ensuring API server file is properly deployed...
[00:45:14] ğŸ”§ Ensuring API server file is properly deployed...
[00:45:14] ğŸ“ Found api_server.py in project api/ directory
[00:45:14] ğŸ“‹ Copying api/api_server.py to /opt/ezrec-backend/api/
[00:45:14] âœ… API server file deployed successfully
[00:45:14] STEP: Installing system dependencies
Hit:1 http://deb.debian.org/debian bookworm InRelease
Hit:2 http://deb.debian.org/debian-security bookworm-security InRelease
Hit:3 http://deb.debian.org/debian bookworm-updates InRelease                    
Hit:4 http://archive.raspberrypi.com/debian bookworm InRelease                   
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
41 packages can be upgraded. Run 'apt list --upgradable' to see them.
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
build-essential is already the newest version (12.9).
libjpeg-dev is already the newest version (1:2.1.5-2).
ffmpeg is already the newest version (8:5.1.7-0+deb12u1+rpt1).
v4l-utils is already the newest version (1.22.1-5+b2).
imagemagick is already the newest version (8:6.9.11.60+dfsg-1.6+deb12u3).
python3-libcamera is already the newest version (0.5.1+rpt20250722-1).
python3-picamera2 is already the newest version (0.3.30-1).
python3-pip is already the newest version (23.0.1+dfsg-1+rpt1).
python3-venv is already the newest version (3.11.2-1+b1).
python3-dev is already the newest version (3.11.2-1+b1).
libavcodec-extra is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libavdevice-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libavfilter-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libavformat-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libavutil-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libswscale-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libswresample-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
v4l2loopback-dkms is already the newest version (0.13.2-1~bpo12+1~rpt1).
python3-opencv is already the newest version (4.6.0+dfsg-12).
libopencv-dev is already the newest version (4.6.0+dfsg-12).
git is already the newest version (1:2.39.5-0+deb12u2).
curl is already the newest version (7.88.1-10+deb12u12).
wget is already the newest version (1.21.3-1+deb12u1).
vim is already the newest version (2:9.0.1378-2+deb12u2).
htop is already the newest version (3.2.2-2).
0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.
[00:45:17] System dependencies installed
[00:45:17] STEP: Setting up users and groups
[00:45:17] Added users to video group
[00:45:17] STEP: Setting up directory structure
[00:45:17] Directory structure created
[00:45:17] STEP: 6. Setting up virtual environments
[00:45:17] Setting up backend virtual environment
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: pip in ./venv/lib/python3.11/site-packages (23.0.1)
Collecting pip
  Downloading https://www.piwheels.org/simple/pip/pip-25.2-py3-none-any.whl (1.8 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 1.8/1.8 MB 1.6 MB/s eta 0:00:00
Installing collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 23.0.1
    Uninstalling pip-23.0.1:
      Successfully uninstalled pip-23.0.1
Successfully installed pip-25.2
[00:45:26] Installing dependencies with PyPI forcing for problematic packages...
[00:45:26] Installing dependencies with optimized conflict resolution...
[00:45:26] Installing core dependencies first...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting fastapi==0.104.1
  Downloading https://www.piwheels.org/simple/fastapi/fastapi-0.104.1-py3-none-any.whl (92 kB)
Collecting uvicorn==0.24.0 (from uvicorn[standard]==0.24.0)
  Downloading https://www.piwheels.org/simple/uvicorn/uvicorn-0.24.0-py3-none-any.whl (59 kB)
Collecting python-multipart==0.0.6
  Downloading https://www.piwheels.org/simple/python-multipart/python_multipart-0.0.6-py3-none-any.whl (45 kB)
Requirement already satisfied: python-dotenv==1.0.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (1.0.0)
Collecting boto3==1.34.0
  Downloading https://archive1.piwheels.org/simple/boto3/boto3-1.34.0-py3-none-any.whl (136 kB)
Collecting supabase==2.0.2
  Downloading https://archive1.piwheels.org/simple/supabase/supabase-2.0.2-py3-none-any.whl (11 kB)
Collecting httpx<0.25.0,>=0.24.0
  Downloading https://www.piwheels.org/simple/httpx/httpx-0.24.1-py3-none-any.whl (75 kB)
Collecting Pillow==10.1.0
  Downloading Pillow-10.1.0-cp311-cp311-manylinux_2_28_aarch64.whl.metadata (9.5 kB)
Collecting simplejpeg==1.6.6
  Downloading simplejpeg-1.6.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl.metadata (6.8 kB)
Collecting av>=15.0.0
  Downloading av-15.1.0-cp311-cp311-manylinux_2_28_aarch64.whl.metadata (4.6 kB)
Collecting picamera2==0.3.12
  Downloading https://www.piwheels.org/simple/picamera2/picamera2-0.3.12-py3-none-any.whl (62 kB)
Requirement already satisfied: numpy>=1.24.0 in /usr/lib/python3/dist-packages (1.24.2)
Requirement already satisfied: psutil>=5.9.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (5.9.5)
Collecting schedule==1.2.0
  Downloading https://www.piwheels.org/simple/schedule/schedule-1.2.0-py3-none-any.whl (11 kB)
Collecting anyio<4.0.0,>=3.7.1 (from fastapi==0.104.1)
  Downloading https://www.piwheels.org/simple/anyio/anyio-3.7.1-py3-none-any.whl (80 kB)
Requirement already satisfied: pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from fastapi==0.104.1) (2.11.7)
Collecting starlette<0.28.0,>=0.27.0 (from fastapi==0.104.1)
  Downloading https://www.piwheels.org/simple/starlette/starlette-0.27.0-py3-none-any.whl (66 kB)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from fastapi==0.104.1) (4.14.0)
Requirement already satisfied: click>=7.0 in /usr/lib/python3/dist-packages (from uvicorn==0.24.0->uvicorn[standard]==0.24.0) (8.1.3)
Requirement already satisfied: h11>=0.8 in /usr/local/lib/python3.11/dist-packages (from uvicorn==0.24.0->uvicorn[standard]==0.24.0) (0.16.0)
Collecting botocore<1.35.0,>=1.34.0 (from boto3==1.34.0)
  Downloading https://www.piwheels.org/simple/botocore/botocore-1.34.162-py3-none-any.whl (12.4 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 12.4/12.4 MB 2.4 MB/s  0:00:05
Requirement already satisfied: jmespath<2.0.0,>=0.7.1 in /usr/lib/python3/dist-packages (from boto3==1.34.0) (1.0.1)
Collecting s3transfer<0.10.0,>=0.9.0 (from boto3==1.34.0)
  Downloading https://archive1.piwheels.org/simple/s3transfer/s3transfer-0.9.0-py3-none-any.whl (82 kB)
Collecting gotrue<2.0.0,>=1.3.0 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/gotrue/gotrue-1.3.1-py3-none-any.whl (42 kB)
Collecting postgrest<0.14.0,>=0.10.8 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/postgrest/postgrest-0.13.2-py3-none-any.whl (19 kB)
Collecting realtime<2.0.0,>=1.0.0 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/realtime/realtime-1.0.6-py3-none-any.whl (9.0 kB)
Collecting storage3<0.7.0,>=0.5.3 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/storage3/storage3-0.6.1-py3-none-any.whl (15 kB)
Collecting supafunc<0.4.0,>=0.3.1 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/supafunc/supafunc-0.3.3-py3-none-any.whl (6.1 kB)
Requirement already satisfied: PiDNG in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (4.0.9)
Requirement already satisfied: piexif in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (1.1.3)
Collecting v4l2-python3 (from picamera2==0.3.12)
  Downloading https://www.piwheels.org/simple/v4l2-python3/v4l2_python3-0.3.5-py3-none-any.whl (22 kB)
Requirement already satisfied: python-prctl in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (1.8.1)
Collecting httptools>=0.5.0 (from uvicorn[standard]==0.24.0)
  Downloading httptools-0.6.4-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (3.6 kB)
Collecting pyyaml>=5.1 (from uvicorn[standard]==0.24.0)
  Downloading PyYAML-6.0.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (2.1 kB)
Collecting uvloop!=0.15.0,!=0.15.1,>=0.14.0 (from uvicorn[standard]==0.24.0)
  Downloading uvloop-0.21.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (4.9 kB)
Collecting watchfiles>=0.13 (from uvicorn[standard]==0.24.0)
  Downloading watchfiles-1.1.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (4.9 kB)
Requirement already satisfied: websockets>=10.4 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from uvicorn[standard]==0.24.0) (12.0)
Requirement already satisfied: certifi in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (2025.6.15)
Collecting httpcore<0.18.0,>=0.15.0 (from httpx<0.25.0,>=0.24.0)
  Downloading https://www.piwheels.org/simple/httpcore/httpcore-0.17.3-py3-none-any.whl (74 kB)
Requirement already satisfied: idna in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (3.10)
Requirement already satisfied: sniffio in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (1.3.1)
Requirement already satisfied: python-dateutil<3.0.0,>=2.1 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from botocore<1.35.0,>=1.34.0->boto3==1.34.0) (2.9.0.post0)
Requirement already satisfied: urllib3!=2.2.0,<3,>=1.25.4 in /usr/lib/python3/dist-packages (from botocore<1.35.0,>=1.34.0->boto3==1.34.0) (1.26.12)
Collecting h11>=0.8 (from uvicorn==0.24.0->uvicorn[standard]==0.24.0)
  Downloading https://www.piwheels.org/simple/h11/h11-0.14.0-py3-none-any.whl (58 kB)
Requirement already satisfied: deprecation<3.0.0,>=2.1.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (2.1.0)
Requirement already satisfied: strenum<0.5.0,>=0.4.9 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (0.4.15)
Requirement already satisfied: packaging in /home/michomanoly14892/.local/lib/python3.11/site-packages (from deprecation<3.0.0,>=2.1.0->postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (25.0)
Requirement already satisfied: annotated-types>=0.6.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (0.7.0)
Requirement already satisfied: pydantic-core==2.33.2 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (2.33.2)
Requirement already satisfied: typing-inspection>=0.4.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (0.4.1)
Requirement already satisfied: six>=1.5 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from python-dateutil<3.0.0,>=2.1->botocore<1.35.0,>=1.34.0->boto3==1.34.0) (1.17.0)
Downloading Pillow-10.1.0-cp311-cp311-manylinux_2_28_aarch64.whl (3.5 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 3.5/3.5 MB 3.0 MB/s  0:00:01
Downloading simplejpeg-1.6.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl (242 kB)
Downloading av-15.1.0-cp311-cp311-manylinux_2_28_aarch64.whl (38.1 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 38.1/38.1 MB 3.0 MB/s  0:00:12
Downloading httptools-0.6.4-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (462 kB)
Downloading PyYAML-6.0.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (736 kB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 736.8/736.8 kB 3.4 MB/s  0:00:00
Downloading uvloop-0.21.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (4.0 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 4.0/4.0 MB 3.1 MB/s  0:00:01
Downloading watchfiles-1.1.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (450 kB)
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: v4l2-python3, uvloop, simplejpeg, schedule, pyyaml, python-multipart, Pillow, httptools, h11, av, anyio, watchfiles, uvicorn, starlette, realtime, picamera2, httpcore, botocore, s3transfer, httpx, fastapi, supafunc, storage3, postgrest, gotrue, boto3, supabase
  Attempting uninstall: simplejpeg
    Found existing installation: simplejpeg 1.8.1
    Not uninstalling simplejpeg at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'simplejpeg'. No files were found to uninstall.
  Attempting uninstall: Pillow
    Found existing installation: Pillow 9.4.0
    Not uninstalling pillow at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'Pillow'. No files were found to uninstall.
  Attempting uninstall: h11
    Found existing installation: h11 0.16.0
    Not uninstalling h11 at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'h11'. No files were found to uninstall.
  Attempting uninstall: av
    Found existing installation: av 12.3.0
    Not uninstalling av at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'av'. No files were found to uninstall.
  Attempting uninstall: anyio
    Found existing installation: anyio 4.9.0
    Not uninstalling anyio at /home/michomanoly14892/.local/lib/python3.11/site-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'anyio'. No files were found to uninstall.
  Attempting uninstall: realtime
    Found existing installation: realtime 2.5.3
    Not uninstalling realtime at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'realtime'. No files were found to uninstall.
  Attempting uninstall: picamera2
    Found existing installation: picamera2 0.3.30
    Not uninstalling picamera2 at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'picamera2'. No files were found to uninstall.
  Attempting uninstall: httpcore
    Found existing installation: httpcore 1.0.9
    Not uninstalling httpcore at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'httpcore'. No files were found to uninstall.
  Attempting uninstall: botocore
    Found existing installation: botocore 1.29.27
    Not uninstalling botocore at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'botocore'. No files were found to uninstall.
  Attempting uninstall: s3transfer
    Found existing installation: s3transfer 0.6.0
    Not uninstalling s3transfer at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 's3transfer'. No files were found to uninstall.
  Attempting uninstall: httpx
    Found existing installation: httpx 0.28.1
    Not uninstalling httpx at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'httpx'. No files were found to uninstall.
  Attempting uninstall: supafunc
    Found existing installation: supafunc 0.10.1
    Not uninstalling supafunc at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'supafunc'. No files were found to uninstall.
  Attempting uninstall: storage3
    Found existing installation: storage3 0.12.0
    Not uninstalling storage3 at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'storage3'. No files were found to uninstall.
  Attempting uninstall: postgrest
    Found existing installation: postgrest 1.1.1
    Not uninstalling postgrest at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'postgrest'. No files were found to uninstall.
  Attempting uninstall: gotrue
    Found existing installation: gotrue 2.12.2
    Not uninstalling gotrue at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'gotrue'. No files were found to uninstall.
  Attempting uninstall: boto3
    Found existing installation: boto3 1.26.27
    Not uninstalling boto3 at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'boto3'. No files were found to uninstall.
  Attempting uninstall: supabase
    Found existing installation: supabase 2.16.0
    Not uninstalling supabase at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'supabase'. No files were found to uninstall.

Successfully installed Pillow-10.1.0 anyio-3.7.1 av-15.1.0 boto3-1.34.0 botocore-1.34.162 fastapi-0.104.1 gotrue-1.3.1 h11-0.14.0 httpcore-0.17.3 httptools-0.6.4 httpx-0.24.1 picamera2-0.3.12 postgrest-0.13.2 python-multipart-0.0.6 pyyaml-6.0.2 realtime-1.0.6 s3transfer-0.9.0 schedule-1.2.0 simplejpeg-1.6.6 starlette-0.27.0 storage3-0.6.1 supabase-2.0.2 supafunc-0.3.3 uvicorn-0.24.0 uvloop-0.21.0 v4l2-python3-0.3.5 watchfiles-1.1.0
[00:46:08] âœ… Core dependencies installed successfully
[00:46:08] Installing OpenCV stitching dependencies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: opencv-python>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (4.11.0.86)
Collecting opencv-contrib-python>=4.8.0
  Downloading opencv_contrib_python-4.12.0.88-cp37-abi3-manylinux2014_aarch64.manylinux_2_17_aarch64.whl.metadata (19 kB)
Requirement already satisfied: numpy>=1.21.2 in /usr/lib/python3/dist-packages (from opencv-python>=4.8.0) (1.24.2)
Collecting numpy>=1.21.2 (from opencv-python>=4.8.0)
  Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (63 kB)
Downloading opencv_contrib_python-4.12.0.88-cp37-abi3-manylinux2014_aarch64.manylinux_2_17_aarch64.whl (51.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 51.3/51.3 MB 3.2 MB/s  0:00:16
Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (14.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.3/14.3 MB 3.3 MB/s  0:00:04
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy, opencv-contrib-python
  Attempting uninstall: numpy
    Found existing installation: numpy 1.24.2
    Not uninstalling numpy at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'numpy'. No files were found to uninstall.

Successfully installed numpy-2.2.6 opencv-contrib-python-4.12.0.88
[00:46:36] âœ… OpenCV dependencies installed successfully
[00:46:36] ğŸ” Verifying backend virtual environment...
Python version: 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0]
[00:46:36] âœ… Virtual environment is valid
[00:46:36] ğŸ”§ Installing typing-extensions with fallback strategies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting typing-extensions>=4.12.0
  Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
WARNING: Error parsing dependencies of send2trash: Expected matching RIGHT_PARENTHESIS for LEFT_PARENTHESIS, after version specifier
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: typing-extensions
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.14.0
    Not uninstalling typing-extensions at /home/michomanoly14892/.local/lib/python3.11/site-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'typing_extensions'. No files were found to uninstall.
Successfully installed typing-extensions-4.15.0
[00:46:38] âœ… typing-extensions installed successfully with version constraint
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting simplejpeg
  Downloading simplejpeg-1.8.2.tar.gz (5.5 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 5.5/5.5 MB 3.0 MB/s  0:00:01
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Collecting numpy>=1.19.3 (from simplejpeg)
  Downloading numpy-2.3.2-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl.metadata (62 kB)
Downloading numpy-2.3.2-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl (14.6 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.6/14.6 MB 3.0 MB/s  0:00:04
Building wheels for collected packages: simplejpeg
  Building wheel for simplejpeg (pyproject.toml): started
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): finished with status 'done'
  Created wheel for simplejpeg: filename=simplejpeg-1.8.2-cp311-cp311-linux_aarch64.whl size=442431 sha256=d911f2a8e364fc4cd0a7482d89ced0f2b951c7b8d984f242174a31f208478551
  Stored in directory: /tmp/pip-ephem-wheel-cache-1nvacql4/wheels/2a/4a/8b/5589c46335d8955dde48df4c3fd1370c51df6df06472dd2103
Successfully built simplejpeg
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy, simplejpeg
  Attempting uninstall: numpy
    Found existing installation: numpy 2.2.6
    Uninstalling numpy-2.2.6:
      Successfully uninstalled numpy-2.2.6
  Attempting uninstall: simplejpeg
    Found existing installation: simplejpeg 1.6.6
    Uninstalling simplejpeg-1.6.6:
      Successfully uninstalled simplejpeg-1.6.6

ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
opencv-contrib-python 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= "3.9", but you have numpy 2.3.2 which is incompatible.
Successfully installed numpy-2.3.2 simplejpeg-1.8.2
[00:50:47] Upgrading PyAV to ensure picamera2 compatibility
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: av>=15.0.0 in ./venv/lib/python3.11/site-packages (15.1.0)
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
[00:50:49] Installing OpenCV stitching dependencies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: opencv-python>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (4.11.0.86)
Requirement already satisfied: opencv-contrib-python>=4.8.0 in ./venv/lib/python3.11/site-packages (4.12.0.88)
Requirement already satisfied: numpy>=1.21.0 in ./venv/lib/python3.11/site-packages (2.3.2)
Collecting numpy>=1.21.0
  Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (63 kB)
Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (14.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.3/14.3 MB 3.8 MB/s  0:00:03
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy
  Attempting uninstall: numpy
    Found existing installation: numpy 2.3.2
    Uninstalling numpy-2.3.2:
      Successfully uninstalled numpy-2.3.2
Successfully installed numpy-2.2.6
[00:50:58] Verifying picamera2 and PyAV compatibility
âœ… picamera2 and PyAV compatibility verified
[00:50:58] âœ… picamera2 and PyAV compatibility verified
[00:50:58] Verifying OpenCV stitching compatibility
âœ… OpenCV stitching compatibility verified
[00:50:59] âœ… OpenCV stitching compatibility verified
[00:50:59] backend virtual environment ready
[00:50:59] Setting up API virtual environment
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: pip in ./venv/lib/python3.11/site-packages (23.0.1)
Collecting pip
  Downloading https://www.piwheels.org/simple/pip/pip-25.2-py3-none-any.whl (1.8 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 1.8/1.8 MB 1.7 MB/s eta 0:00:00
Installing collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 23.0.1
    Uninstalling pip-23.0.1:
      Successfully uninstalled pip-23.0.1
Successfully installed pip-25.2
[00:51:07] Installing dependencies with PyPI forcing for problematic packages...
[00:51:07] Installing dependencies with optimized conflict resolution...
[00:51:07] Installing core dependencies first...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting fastapi==0.104.1
  Downloading https://www.piwheels.org/simple/fastapi/fastapi-0.104.1-py3-none-any.whl (92 kB)
Collecting uvicorn==0.24.0 (from uvicorn[standard]==0.24.0)
  Downloading https://www.piwheels.org/simple/uvicorn/uvicorn-0.24.0-py3-none-any.whl (59 kB)
Collecting python-multipart==0.0.6
  Downloading https://www.piwheels.org/simple/python-multipart/python_multipart-0.0.6-py3-none-any.whl (45 kB)
Requirement already satisfied: python-dotenv==1.0.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (1.0.0)
Collecting boto3==1.34.0
  Downloading https://archive1.piwheels.org/simple/boto3/boto3-1.34.0-py3-none-any.whl (136 kB)
Collecting supabase==2.0.2
  Downloading https://archive1.piwheels.org/simple/supabase/supabase-2.0.2-py3-none-any.whl (11 kB)
Collecting httpx<0.25.0,>=0.24.0
  Downloading https://www.piwheels.org/simple/httpx/httpx-0.24.1-py3-none-any.whl (75 kB)
Collecting Pillow==10.1.0
  Downloading Pillow-10.1.0-cp311-cp311-manylinux_2_28_aarch64.whl.metadata (9.5 kB)
Collecting simplejpeg==1.6.6
  Downloading simplejpeg-1.6.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl.metadata (6.8 kB)
Collecting av>=15.0.0
  Downloading av-15.1.0-cp311-cp311-manylinux_2_28_aarch64.whl.metadata (4.6 kB)
Collecting picamera2==0.3.12
  Downloading https://www.piwheels.org/simple/picamera2/picamera2-0.3.12-py3-none-any.whl (62 kB)
Requirement already satisfied: numpy>=1.24.0 in /usr/lib/python3/dist-packages (1.24.2)
Requirement already satisfied: psutil>=5.9.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (5.9.5)
Collecting schedule==1.2.0
  Downloading https://www.piwheels.org/simple/schedule/schedule-1.2.0-py3-none-any.whl (11 kB)
Collecting anyio<4.0.0,>=3.7.1 (from fastapi==0.104.1)
  Downloading https://www.piwheels.org/simple/anyio/anyio-3.7.1-py3-none-any.whl (80 kB)
Requirement already satisfied: pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from fastapi==0.104.1) (2.11.7)
Collecting starlette<0.28.0,>=0.27.0 (from fastapi==0.104.1)
  Downloading https://www.piwheels.org/simple/starlette/starlette-0.27.0-py3-none-any.whl (66 kB)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from fastapi==0.104.1) (4.14.0)
Requirement already satisfied: click>=7.0 in /usr/lib/python3/dist-packages (from uvicorn==0.24.0->uvicorn[standard]==0.24.0) (8.1.3)
Requirement already satisfied: h11>=0.8 in /usr/local/lib/python3.11/dist-packages (from uvicorn==0.24.0->uvicorn[standard]==0.24.0) (0.16.0)
Collecting botocore<1.35.0,>=1.34.0 (from boto3==1.34.0)
  Downloading https://www.piwheels.org/simple/botocore/botocore-1.34.162-py3-none-any.whl (12.4 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 12.4/12.4 MB 3.2 MB/s  0:00:04
Requirement already satisfied: jmespath<2.0.0,>=0.7.1 in /usr/lib/python3/dist-packages (from boto3==1.34.0) (1.0.1)
Collecting s3transfer<0.10.0,>=0.9.0 (from boto3==1.34.0)
  Downloading https://archive1.piwheels.org/simple/s3transfer/s3transfer-0.9.0-py3-none-any.whl (82 kB)
Collecting gotrue<2.0.0,>=1.3.0 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/gotrue/gotrue-1.3.1-py3-none-any.whl (42 kB)
Collecting postgrest<0.14.0,>=0.10.8 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/postgrest/postgrest-0.13.2-py3-none-any.whl (19 kB)
Collecting realtime<2.0.0,>=1.0.0 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/realtime/realtime-1.0.6-py3-none-any.whl (9.0 kB)
Collecting storage3<0.7.0,>=0.5.3 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/storage3/storage3-0.6.1-py3-none-any.whl (15 kB)
Collecting supafunc<0.4.0,>=0.3.1 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/supafunc/supafunc-0.3.3-py3-none-any.whl (6.1 kB)
Requirement already satisfied: PiDNG in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (4.0.9)
Requirement already satisfied: piexif in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (1.1.3)
Collecting v4l2-python3 (from picamera2==0.3.12)
  Downloading https://www.piwheels.org/simple/v4l2-python3/v4l2_python3-0.3.5-py3-none-any.whl (22 kB)
Requirement already satisfied: python-prctl in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (1.8.1)
Collecting httptools>=0.5.0 (from uvicorn[standard]==0.24.0)
  Downloading httptools-0.6.4-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (3.6 kB)
Collecting pyyaml>=5.1 (from uvicorn[standard]==0.24.0)
  Downloading PyYAML-6.0.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (2.1 kB)
Collecting uvloop!=0.15.0,!=0.15.1,>=0.14.0 (from uvicorn[standard]==0.24.0)
  Downloading uvloop-0.21.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (4.9 kB)
Collecting watchfiles>=0.13 (from uvicorn[standard]==0.24.0)
  Downloading watchfiles-1.1.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (4.9 kB)
Requirement already satisfied: websockets>=10.4 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from uvicorn[standard]==0.24.0) (12.0)
Requirement already satisfied: certifi in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (2025.6.15)
Collecting httpcore<0.18.0,>=0.15.0 (from httpx<0.25.0,>=0.24.0)
  Downloading https://www.piwheels.org/simple/httpcore/httpcore-0.17.3-py3-none-any.whl (74 kB)
Requirement already satisfied: idna in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (3.10)
Requirement already satisfied: sniffio in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (1.3.1)
Requirement already satisfied: python-dateutil<3.0.0,>=2.1 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from botocore<1.35.0,>=1.34.0->boto3==1.34.0) (2.9.0.post0)
Requirement already satisfied: urllib3!=2.2.0,<3,>=1.25.4 in /usr/lib/python3/dist-packages (from botocore<1.35.0,>=1.34.0->boto3==1.34.0) (1.26.12)
Collecting h11>=0.8 (from uvicorn==0.24.0->uvicorn[standard]==0.24.0)
  Downloading https://www.piwheels.org/simple/h11/h11-0.14.0-py3-none-any.whl (58 kB)
Requirement already satisfied: deprecation<3.0.0,>=2.1.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (2.1.0)
Requirement already satisfied: strenum<0.5.0,>=0.4.9 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (0.4.15)
Requirement already satisfied: packaging in /home/michomanoly14892/.local/lib/python3.11/site-packages (from deprecation<3.0.0,>=2.1.0->postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (25.0)
Requirement already satisfied: annotated-types>=0.6.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (0.7.0)
Requirement already satisfied: pydantic-core==2.33.2 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (2.33.2)
Requirement already satisfied: typing-inspection>=0.4.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (0.4.1)
Requirement already satisfied: six>=1.5 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from python-dateutil<3.0.0,>=2.1->botocore<1.35.0,>=1.34.0->boto3==1.34.0) (1.17.0)
Downloading Pillow-10.1.0-cp311-cp311-manylinux_2_28_aarch64.whl (3.5 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 3.5/3.5 MB 2.7 MB/s  0:00:01
Downloading simplejpeg-1.6.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl (242 kB)
Downloading av-15.1.0-cp311-cp311-manylinux_2_28_aarch64.whl (38.1 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 38.1/38.1 MB 3.3 MB/s  0:00:11
Downloading httptools-0.6.4-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (462 kB)
Downloading PyYAML-6.0.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (736 kB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 736.8/736.8 kB 3.4 MB/s  0:00:00
Downloading uvloop-0.21.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (4.0 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 4.0/4.0 MB 3.1 MB/s  0:00:01
Downloading watchfiles-1.1.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (450 kB)
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: v4l2-python3, uvloop, simplejpeg, schedule, pyyaml, python-multipart, Pillow, httptools, h11, av, anyio, watchfiles, uvicorn, starlette, realtime, picamera2, httpcore, botocore, s3transfer, httpx, fastapi, supafunc, storage3, postgrest, gotrue, boto3, supabase
  Attempting uninstall: simplejpeg
    Found existing installation: simplejpeg 1.8.1
    Not uninstalling simplejpeg at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'simplejpeg'. No files were found to uninstall.
  Attempting uninstall: Pillow
    Found existing installation: Pillow 9.4.0
    Not uninstalling pillow at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'Pillow'. No files were found to uninstall.
  Attempting uninstall: h11
    Found existing installation: h11 0.16.0
    Not uninstalling h11 at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'h11'. No files were found to uninstall.
  Attempting uninstall: av
    Found existing installation: av 12.3.0
    Not uninstalling av at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'av'. No files were found to uninstall.
  Attempting uninstall: anyio
    Found existing installation: anyio 4.9.0
    Not uninstalling anyio at /home/michomanoly14892/.local/lib/python3.11/site-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'anyio'. No files were found to uninstall.
  Attempting uninstall: realtime
    Found existing installation: realtime 2.5.3
    Not uninstalling realtime at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'realtime'. No files were found to uninstall.
  Attempting uninstall: picamera2
    Found existing installation: picamera2 0.3.30
    Not uninstalling picamera2 at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'picamera2'. No files were found to uninstall.
  Attempting uninstall: httpcore
    Found existing installation: httpcore 1.0.9
    Not uninstalling httpcore at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'httpcore'. No files were found to uninstall.
  Attempting uninstall: botocore
    Found existing installation: botocore 1.29.27
    Not uninstalling botocore at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'botocore'. No files were found to uninstall.
  Attempting uninstall: s3transfer
    Found existing installation: s3transfer 0.6.0
    Not uninstalling s3transfer at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 's3transfer'. No files were found to uninstall.
  Attempting uninstall: httpx
    Found existing installation: httpx 0.28.1
    Not uninstalling httpx at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'httpx'. No files were found to uninstall.
  Attempting uninstall: supafunc
    Found existing installation: supafunc 0.10.1
    Not uninstalling supafunc at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'supafunc'. No files were found to uninstall.
  Attempting uninstall: storage3
    Found existing installation: storage3 0.12.0
    Not uninstalling storage3 at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'storage3'. No files were found to uninstall.
  Attempting uninstall: postgrest
    Found existing installation: postgrest 1.1.1
    Not uninstalling postgrest at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'postgrest'. No files were found to uninstall.
  Attempting uninstall: gotrue
    Found existing installation: gotrue 2.12.2
    Not uninstalling gotrue at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'gotrue'. No files were found to uninstall.
  Attempting uninstall: boto3
    Found existing installation: boto3 1.26.27
    Not uninstalling boto3 at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'boto3'. No files were found to uninstall.
  Attempting uninstall: supabase
    Found existing installation: supabase 2.16.0
    Not uninstalling supabase at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'supabase'. No files were found to uninstall.

Successfully installed Pillow-10.1.0 anyio-3.7.1 av-15.1.0 boto3-1.34.0 botocore-1.34.162 fastapi-0.104.1 gotrue-1.3.1 h11-0.14.0 httpcore-0.17.3 httptools-0.6.4 httpx-0.24.1 picamera2-0.3.12 postgrest-0.13.2 python-multipart-0.0.6 pyyaml-6.0.2 realtime-1.0.6 s3transfer-0.9.0 schedule-1.2.0 simplejpeg-1.6.6 starlette-0.27.0 storage3-0.6.1 supabase-2.0.2 supafunc-0.3.3 uvicorn-0.24.0 uvloop-0.21.0 v4l2-python3-0.3.5 watchfiles-1.1.0
[00:51:45] âœ… Core dependencies installed successfully
[00:51:45] Installing OpenCV stitching dependencies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: opencv-python>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (4.11.0.86)
Collecting opencv-contrib-python>=4.8.0
  Downloading opencv_contrib_python-4.12.0.88-cp37-abi3-manylinux2014_aarch64.manylinux_2_17_aarch64.whl.metadata (19 kB)
Requirement already satisfied: numpy>=1.21.2 in /usr/lib/python3/dist-packages (from opencv-python>=4.8.0) (1.24.2)
Collecting numpy>=1.21.2 (from opencv-python>=4.8.0)
  Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (63 kB)
Downloading opencv_contrib_python-4.12.0.88-cp37-abi3-manylinux2014_aarch64.manylinux_2_17_aarch64.whl (51.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 51.3/51.3 MB 3.1 MB/s  0:00:16
Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (14.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.3/14.3 MB 3.1 MB/s  0:00:04
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy, opencv-contrib-python
  Attempting uninstall: numpy
    Found existing installation: numpy 1.24.2
    Not uninstalling numpy at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'numpy'. No files were found to uninstall.

Successfully installed numpy-2.2.6 opencv-contrib-python-4.12.0.88
[00:52:13] âœ… OpenCV dependencies installed successfully
[00:52:13] ğŸ” Verifying API virtual environment...
Python version: 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0]
[00:52:13] âœ… Virtual environment is valid
[00:52:13] ğŸ”§ Installing typing-extensions with fallback strategies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting typing-extensions>=4.12.0
  Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
WARNING: Error parsing dependencies of send2trash: Expected matching RIGHT_PARENTHESIS for LEFT_PARENTHESIS, after version specifier
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: typing-extensions
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.14.0
    Not uninstalling typing-extensions at /home/michomanoly14892/.local/lib/python3.11/site-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'typing_extensions'. No files were found to uninstall.
Successfully installed typing-extensions-4.15.0
[00:52:17] âœ… typing-extensions installed successfully with version constraint
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting simplejpeg
  Downloading simplejpeg-1.8.2.tar.gz (5.5 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 5.5/5.5 MB 2.2 MB/s  0:00:02
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Collecting numpy>=1.19.3 (from simplejpeg)
  Downloading numpy-2.3.2-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl.metadata (62 kB)
Downloading numpy-2.3.2-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl (14.6 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.6/14.6 MB 2.4 MB/s  0:00:06
Building wheels for collected packages: simplejpeg
  Building wheel for simplejpeg (pyproject.toml): started
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): finished with status 'done'
  Created wheel for simplejpeg: filename=simplejpeg-1.8.2-cp311-cp311-linux_aarch64.whl size=442430 sha256=ceb75e23f85c3a2ba8f147fa4fb52145c7d6f17f592a40fa5d6b4bcacd9935d5
  Stored in directory: /tmp/pip-ephem-wheel-cache-wsdday73/wheels/2a/4a/8b/5589c46335d8955dde48df4c3fd1370c51df6df06472dd2103
Successfully built simplejpeg
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy, simplejpeg
  Attempting uninstall: numpy
    Found existing installation: numpy 2.2.6
    Uninstalling numpy-2.2.6:
      Successfully uninstalled numpy-2.2.6
  Attempting uninstall: simplejpeg
    Found existing installation: simplejpeg 1.6.6
    Uninstalling simplejpeg-1.6.6:
      Successfully uninstalled simplejpeg-1.6.6

ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
opencv-contrib-python 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= "3.9", but you have numpy 2.3.2 which is incompatible.
Successfully installed numpy-2.3.2 simplejpeg-1.8.2
[00:56:25] Upgrading PyAV to ensure picamera2 compatibility
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: av>=15.0.0 in ./venv/lib/python3.11/site-packages (15.1.0)
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
[00:56:27] Installing OpenCV stitching dependencies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: opencv-python>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (4.11.0.86)
Requirement already satisfied: opencv-contrib-python>=4.8.0 in ./venv/lib/python3.11/site-packages (4.12.0.88)
Requirement already satisfied: numpy>=1.21.0 in ./venv/lib/python3.11/site-packages (2.3.2)
Collecting numpy>=1.21.0
  Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (63 kB)
Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (14.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.3/14.3 MB 1.8 MB/s  0:00:08
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy
  Attempting uninstall: numpy
    Found existing installation: numpy 2.3.2
    Uninstalling numpy-2.3.2:
      Successfully uninstalled numpy-2.3.2
Successfully installed numpy-2.2.6
[00:56:41] Verifying picamera2 and PyAV compatibility
âœ… picamera2 and PyAV compatibility verified
[00:56:41] âœ… picamera2 and PyAV compatibility verified
[00:56:41] Verifying OpenCV stitching compatibility
âœ… OpenCV stitching compatibility verified
[00:56:42] âœ… OpenCV stitching compatibility verified
[00:56:42] API virtual environment ready
[00:56:42] STEP: 7. Applying fixes
[00:56:42] Creating improved kms.py placeholder for picamera2 compatibility
[00:56:42] Improved kms.py placeholder created
[00:56:42] Deploying working video_worker with all fixes...
[00:56:42] âœ… video_worker.py exists and will be used
[00:56:42] Setting up assets directory
[00:56:42] Starting asset download with timeout protection...
[00:56:42] Checking and downloading user assets (smart mode)
[00:56:42] Current directory: /opt/ezrec-backend
[00:56:42] Checking if .env exists: -rwxr-xr-x 1 michomanoly14892 michomanoly14892 2672 Aug 31 00:45 .env
[00:56:46] âœ… Asset check/download completed successfully
[00:56:46] Smart asset download process completed
[00:56:46] âœ… Asset download completed
[00:56:46] STEP: Setting up files and permissions
[00:56:46] Files and permissions set up
[00:56:46] STEP: Installing systemd services
Created symlink /etc/systemd/system/multi-user.target.wants/dual_recorder.service â†’ /etc/systemd/system/dual_recorder.service.
Created symlink /etc/systemd/system/multi-user.target.wants/video_worker.service â†’ /etc/systemd/system/video_worker.service.
Created symlink /etc/systemd/system/multi-user.target.wants/ezrec-api.service â†’ /etc/systemd/system/ezrec-api.service.
Created symlink /etc/systemd/system/multi-user.target.wants/system_status.service â†’ /etc/systemd/system/system_status.service.
[00:56:47] Systemd services installed and enabled
[00:56:47] STEP: Setting up cron jobs
[00:56:47] Cron jobs configured
[00:56:47] STEP: Starting services
[00:56:47] STEP: Preventing port conflicts
[00:56:47] ğŸ”§ Checking for port conflicts...
[00:56:47] ğŸ›‘ Stopping all EZREC services...
[00:56:47] ğŸ§¹ Cleaning up any existing API server processes...
[00:56:50] ğŸ”§ Final cleanup - killing any remaining processes on our ports...
[00:56:50] âœ… Port 8000 is now free
[00:56:50] âœ… Port 9000 is now free
[00:56:50] Port conflict prevention completed
[00:56:50] Starting dual_recorder.service
[00:56:50] Starting video_worker.service
[00:56:50] Starting ezrec-api.service
[00:56:50] Starting system_status.service
[00:56:53] Starting system_status.timer
[00:56:59] Restarting dual_recorder.service
[00:57:07] Restarting video_worker.service
[00:57:07] Restarting ezrec-api.service
[00:57:07] ğŸ”§ Double-checking port 8000 is free before starting API server...
[00:57:07] ğŸ”§ Final API server port cleanup...
[00:57:10] Restarting system_status.service
[00:57:22] Services started
[00:57:22] STEP: Completing interrupted deployment
[00:57:22] ğŸ”„ Completing setup_cron step...
[00:57:22] STEP: Setting up cron jobs
[00:57:22] Cron jobs configured
[00:57:22] âœ… Interrupted deployment completed
[00:57:22] ğŸ“¦ Deploying updated video_worker.py...
[00:57:22] âœ… video_worker.py exists and will be used
[00:57:22] Deploying working video_worker with all fixes...
[00:57:22] âœ… video_worker.py exists and will be used
[00:57:22] ğŸ” Restarting video_worker.service...
[00:57:22] âœ… video_worker.service restarted successfully
[00:57:22] ğŸ“¦ Deploying updated dual_recorder.py and enhanced_merge.py...
[00:57:22] âœ… dual_recorder.py exists and will be used
[00:57:22] âœ… enhanced_merge.py exists and will be used
[00:57:22] ğŸ” Restarting dual_recorder.service...
[00:57:30] âœ… dual_recorder.service restarted successfully
[00:57:30] STEP: Validating deployment
[00:57:30] âœ… dual_recorder.service is running
[00:57:30] âœ… video_worker.service is running
[00:57:30] ERROR: ezrec-api.service failed to start
[00:57:30] ERROR: Detailed status for ezrec-api:
â— ezrec-api.service - EZREC FastAPI Backend
     Loaded: loaded (/etc/systemd/system/ezrec-api.service; enabled; preset: enabled)
     Active: activating (auto-restart) (Result: exit-code) since Sun 2025-08-31 00:57:23 EDT; 7s ago
    Process: 580306 ExecStart=/opt/ezrec-backend/api/venv/bin/uvicorn api_server:app --host 0.0.0.0 --port 8000 (code=exited, status=1/FAILURE)
   Main PID: 580306 (code=exited, status=1/FAILURE)
        CPU: 1.620s

Aug 31 00:57:23 raspberrypi systemd[1]: ezrec-api.service: Consumed 1.620s CPU time.
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ # Test the API endpoints
curl -s http://localhost:8000/test-alive
curl -s http://localhost:8000/status

# Check if all services are running
sudo systemctl status ezrec-api.service
sudo systemctl status dual_recorder.service
sudo systemctl status video_worker.service
sudo systemctl status system_status.service
â— ezrec-api.service - EZREC FastAPI Backend
     Loaded: loaded (/etc/systemd/system/ezrec-api.service; enabled; preset: enabled)
     Active: activating (auto-restart) (Result: exit-code) since Sun 2025-08-31 00:59:04 EDT; 4s ago
    Process: 581047 ExecStart=/opt/ezrec-backend/api/venv/bin/uvicorn api_server:app --host 0.0.0.0 --port 8000 (code=exited, status=1/FAILURE)
   Main PID: 581047 (code=exited, status=1/FAILURE)
        CPU: 1.463s
â— dual_recorder.service - EZREC Dual Camera Recorder Service
     Loaded: loaded (/etc/systemd/system/dual_recorder.service; enabled; preset: enabled)
     Active: active (running) since Sun 2025-08-31 00:57:30 EDT; 1min 39s ago
   Main PID: 580760 (python3)
      Tasks: 6 (limit: 9572)
        CPU: 1.376s
     CGroup: /system.slice/dual_recorder.service
             â””â”€580760 /opt/ezrec-backend/backend/venv/bin/python3 /opt/ezrec-backend/backend/dual_recorder.py

Aug 31 00:59:02 raspberrypi python3[580760]: 2025-08-31 00:59:02,086 - INFO - ğŸ“‹ Loaded 0 bookings from cache
Aug 31 00:59:02 raspberrypi python3[580760]: 2025-08-31 00:59:02,088 - INFO - ğŸ” Checking 0 bookings at 2025-08-31 00:59:02 EDT
Aug 31 00:59:02 raspberrypi python3[580760]: 2025-08-31 00:59:02,088 - INFO - ğŸ” Looking for user_id: 65aa2e2a-e463-424d-b88f-0724bb0bea3a, camera_id: d217e751-dfa5-5276-abbb-da5ad6c2626a
Aug 31 00:59:02 raspberrypi python3[580760]: 2025-08-31 00:59:02,088 - INFO - âŒ No active booking found
Aug 31 00:59:02 raspberrypi python3[580760]: 2025-08-31 00:59:02,088 - INFO - â³ No active booking found, waiting...
Aug 31 00:59:07 raspberrypi python3[580760]: 2025-08-31 00:59:07,088 - INFO - ğŸ“‹ Loaded 0 bookings from cache
Aug 31 00:59:07 raspberrypi python3[580760]: 2025-08-31 00:59:07,093 - INFO - ğŸ” Checking 0 bookings at 2025-08-31 00:59:07 EDT
Aug 31 00:59:07 raspberrypi python3[580760]: 2025-08-31 00:59:07,093 - INFO - ğŸ” Looking for user_id: 65aa2e2a-e463-424d-b88f-0724bb0bea3a, camera_id: d217e751-dfa5-5276-abbb-da5ad6c2626a
Aug 31 00:59:07 raspberrypi python3[580760]: 2025-08-31 00:59:07,093 - INFO - âŒ No active booking found
Aug 31 00:59:07 raspberrypi python3[580760]: 2025-08-31 00:59:07,093 - INFO - â³ No active booking found, waiting...
â— video_worker.service - EZREC Video Processing Worker Service
     Loaded: loaded (/etc/systemd/system/video_worker.service; enabled; preset: enabled)
     Active: active (running) since Sun 2025-08-31 00:57:22 EDT; 1min 46s ago
   Main PID: 580332 (python3)
      Tasks: 1 (limit: 9572)
        CPU: 872ms
     CGroup: /system.slice/video_worker.service
             â””â”€580332 /opt/ezrec-backend/backend/venv/bin/python3 /opt/ezrec-backend/backend/video_worker.py

Aug 31 00:57:23 raspberrypi python3[580332]: 2025-08-31 00:57:23,405 [INFO] ğŸ§¹ Running startup cleanup of orphaned marker files...
Aug 31 00:57:23 raspberrypi python3[580332]: 2025-08-31 00:57:23,405 [INFO] âœ… Startup cleanup: no orphaned marker files found
Aug 31 00:57:23 raspberrypi python3[580332]: 2025-08-31 00:57:23,459 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:57:38 raspberrypi python3[580332]: 2025-08-31 00:57:38,497 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:57:53 raspberrypi python3[580332]: 2025-08-31 00:57:53,544 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:58:08 raspberrypi python3[580332]: 2025-08-31 00:58:08,583 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:58:23 raspberrypi python3[580332]: 2025-08-31 00:58:23,612 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:58:38 raspberrypi python3[580332]: 2025-08-31 00:58:38,636 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:58:53 raspberrypi python3[580332]: 2025-08-31 00:58:53,664 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
Aug 31 00:59:08 raspberrypi python3[580332]: 2025-08-31 00:59:08,706 [INFO] ğŸ“Š Disk usage: 8.1% used, 101.6 GB free
â— system_status.service - EZREC System Status Monitor
     Loaded: loaded (/etc/systemd/system/system_status.service; enabled; preset: enabled)
     Active: active (exited) since Sun 2025-08-31 00:57:12 EDT; 1min 57s ago
TriggeredBy: â— system_status.timer
    Process: 580260 ExecStart=/opt/ezrec-backend/backend/venv/bin/python3 /opt/ezrec-backend/backend/system_status.py (code=exited, status=0/SUCCESS)
   Main PID: 580260 (code=exited, status=0/SUCCESS)
        CPU: 1.053s

Aug 31 00:57:11 raspberrypi python3[580260]: [78:08:29.585938086] [580276] ERROR RPI pisp.cpp:947 Failed to register camera imx477 11-001a: -22
Aug 31 00:57:11 raspberrypi python3[580260]: 2025-08-31 00:57:11,889 [INFO] Initialization successful.
Aug 31 00:57:11 raspberrypi python3[580260]: 2025-08-31 00:57:11,889 [INFO] Camera now open.
Aug 31 00:57:12 raspberrypi python3[580260]: 2025-08-31 00:57:12,090 [INFO] Camera closed successfully.
Aug 31 00:57:12 raspberrypi python3[580260]: 2025-08-31 00:57:12,268 [INFO] ğŸ“Š Overall Status: CRITICAL
Aug 31 00:57:12 raspberrypi python3[580260]: 2025-08-31 00:57:12,268 [ERROR] ğŸš¨ Critical Issues: Inactive services: ezrec-api.service
Aug 31 00:57:12 raspberrypi python3[580260]: 2025-08-31 00:57:12,269 [INFO] âœ… Status saved to /opt/ezrec-backend/status.json
Aug 31 00:57:12 raspberrypi python3[580260]: 2025-08-31 00:57:12,269 [INFO] âœ… Health check completed successfully
Aug 31 00:57:12 raspberrypi python3[580260]: 2025-08-31 00:57:12,269 [INFO] âœ… System Status: critical
Aug 31 00:57:12 raspberrypi systemd[1]: Finished system_status.service - EZREC System Status Monitor.
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ 