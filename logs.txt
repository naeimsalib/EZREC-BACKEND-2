michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ git pull
remote: Enumerating objects: 5, done.
remote: Counting objects: 100% (5/5), done.
remote: Compressing objects: 100% (1/1), done.
remote: Total 3 (delta 2), reused 3 (delta 2), pack-reused 0 (from 0)
Unpacking objects: 100% (3/3), 1.92 KiB | 983.00 KiB/s, done.
From https://github.com/naeimsalib/EZREC-BACKEND-2
   a27c3b4..c4a8894  main       -> origin/main
Updating a27c3b4..c4a8894
error: Your local changes to the following files would be overwritten by merge:
        deployment.sh
Please commit your changes or stash them before you merge.
Aborting
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ git stash
Saved working directory and index state WIP on main: a27c3b4 Add timeout protection and fix typing-extensions hanging issue in deployment
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ git pull
Updating a27c3b4..c4a8894
Fast-forward
 deployment.sh | 77 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++---------
 1 file changed, 68 insertions(+), 9 deletions(-)
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ sudo chmod +x deployment.sh 
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ sudo ./deployment.sh 
[23:50:27] Starting EZREC deployment as user: root
[23:50:27] STEP: 1. Stopping old services
[23:50:27] Managing dual_recorder: stop
[23:50:34] Managing video_worker: stop
[23:50:34] Managing ezrec-api: stop
[23:50:34] Managing system_status: stop
[23:50:34] Managing dual_recorder: disable
[23:50:35] Managing video_worker: disable
[23:50:35] Managing ezrec-api: disable
[23:50:35] Managing system_status: disable
[23:50:35] STEP: 2. Cleaning up old installation
[23:50:35] ğŸ”’ Backing up existing .env file
[23:50:35] âœ… .env file backed up successfully
[23:50:35] ğŸ§¹ Cleaning up old installation (preserving .env)...
[23:50:35] ğŸ”’ .env file found - will preserve it during cleanup
[23:50:36] âœ… Cleaned up old files (preserved .env)
[23:50:36] âœ… .env file successfully preserved
[23:50:36] STEP: 3. Copying project files
[23:50:36] ğŸ”’ Restoring .env file
[23:50:36] âœ… .env file restored successfully
[23:50:36] ğŸ”§ Ensuring required environment variables are present...
[23:50:36] âœ… All required environment variables are present
[23:50:36] STEP: Installing system dependencies
Hit:1 http://deb.debian.org/debian bookworm InRelease
Hit:2 http://deb.debian.org/debian-security bookworm-security InRelease
Hit:3 http://deb.debian.org/debian bookworm-updates InRelease
Hit:4 http://archive.raspberrypi.com/debian bookworm InRelease
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
41 packages can be upgraded. Run 'apt list --upgradable' to see them.
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
build-essential is already the newest version (12.9).
libjpeg-dev is already the newest version (1:2.1.5-2).
ffmpeg is already the newest version (8:5.1.7-0+deb12u1+rpt1).
v4l-utils is already the newest version (1.22.1-5+b2).
imagemagick is already the newest version (8:6.9.11.60+dfsg-1.6+deb12u3).
python3-libcamera is already the newest version (0.5.1+rpt20250722-1).
python3-picamera2 is already the newest version (0.3.30-1).
python3-pip is already the newest version (23.0.1+dfsg-1+rpt1).
python3-venv is already the newest version (3.11.2-1+b1).
python3-dev is already the newest version (3.11.2-1+b1).
libavcodec-extra is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libavdevice-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libavfilter-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libavformat-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libavutil-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libswscale-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
libswresample-dev is already the newest version (8:5.1.7-0+deb12u1+rpt1).
v4l2loopback-dkms is already the newest version (0.13.2-1~bpo12+1~rpt1).
python3-opencv is already the newest version (4.6.0+dfsg-12).
libopencv-dev is already the newest version (4.6.0+dfsg-12).
git is already the newest version (1:2.39.5-0+deb12u2).
curl is already the newest version (7.88.1-10+deb12u12).
wget is already the newest version (1.21.3-1+deb12u1).
vim is already the newest version (2:9.0.1378-2+deb12u2).
htop is already the newest version (3.2.2-2).
0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.
[23:50:39] System dependencies installed
[23:50:39] STEP: Setting up users and groups
[23:50:39] Added users to video group
[23:50:39] STEP: Setting up directory structure
[23:50:39] Directory structure created
[23:50:39] STEP: 6. Setting up virtual environments
[23:50:39] Setting up backend virtual environment
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: pip in ./venv/lib/python3.11/site-packages (23.0.1)
Collecting pip
  Downloading https://www.piwheels.org/simple/pip/pip-25.2-py3-none-any.whl (1.8 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 1.8/1.8 MB 1.7 MB/s eta 0:00:00
Installing collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 23.0.1
    Uninstalling pip-23.0.1:
      Successfully uninstalled pip-23.0.1
Successfully installed pip-25.2
[23:50:48] Installing dependencies with PyPI forcing for problematic packages...
[23:50:48] Installing dependencies with optimized conflict resolution...
[23:50:48] Installing core dependencies first...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting fastapi==0.104.1
  Downloading https://www.piwheels.org/simple/fastapi/fastapi-0.104.1-py3-none-any.whl (92 kB)
Collecting uvicorn==0.24.0 (from uvicorn[standard]==0.24.0)
  Downloading https://www.piwheels.org/simple/uvicorn/uvicorn-0.24.0-py3-none-any.whl (59 kB)
Collecting python-multipart==0.0.6
  Downloading https://www.piwheels.org/simple/python-multipart/python_multipart-0.0.6-py3-none-any.whl (45 kB)
Requirement already satisfied: python-dotenv==1.0.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (1.0.0)
Collecting boto3==1.34.0
  Downloading https://archive1.piwheels.org/simple/boto3/boto3-1.34.0-py3-none-any.whl (136 kB)
Collecting supabase==2.0.2
  Downloading https://archive1.piwheels.org/simple/supabase/supabase-2.0.2-py3-none-any.whl (11 kB)
Collecting httpx<0.25.0,>=0.24.0
  Downloading https://www.piwheels.org/simple/httpx/httpx-0.24.1-py3-none-any.whl (75 kB)
Collecting Pillow==10.1.0
  Downloading Pillow-10.1.0-cp311-cp311-manylinux_2_28_aarch64.whl.metadata (9.5 kB)
Collecting simplejpeg==1.6.6
  Downloading simplejpeg-1.6.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl.metadata (6.8 kB)
Collecting av>=15.0.0
  Downloading av-15.1.0-cp311-cp311-manylinux_2_28_aarch64.whl.metadata (4.6 kB)
Collecting picamera2==0.3.12
  Downloading https://www.piwheels.org/simple/picamera2/picamera2-0.3.12-py3-none-any.whl (62 kB)
Requirement already satisfied: numpy>=1.24.0 in /usr/lib/python3/dist-packages (1.24.2)
Requirement already satisfied: psutil>=5.9.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (5.9.5)
Collecting schedule==1.2.0
  Downloading https://www.piwheels.org/simple/schedule/schedule-1.2.0-py3-none-any.whl (11 kB)
Collecting anyio<4.0.0,>=3.7.1 (from fastapi==0.104.1)
  Downloading https://www.piwheels.org/simple/anyio/anyio-3.7.1-py3-none-any.whl (80 kB)
Requirement already satisfied: pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from fastapi==0.104.1) (2.11.7)
Collecting starlette<0.28.0,>=0.27.0 (from fastapi==0.104.1)
  Downloading https://www.piwheels.org/simple/starlette/starlette-0.27.0-py3-none-any.whl (66 kB)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from fastapi==0.104.1) (4.14.0)
Requirement already satisfied: click>=7.0 in /usr/lib/python3/dist-packages (from uvicorn==0.24.0->uvicorn[standard]==0.24.0) (8.1.3)
Requirement already satisfied: h11>=0.8 in /usr/local/lib/python3.11/dist-packages (from uvicorn==0.24.0->uvicorn[standard]==0.24.0) (0.16.0)
Collecting botocore<1.35.0,>=1.34.0 (from boto3==1.34.0)
  Downloading https://www.piwheels.org/simple/botocore/botocore-1.34.162-py3-none-any.whl (12.4 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 12.4/12.4 MB 2.7 MB/s  0:00:04
Requirement already satisfied: jmespath<2.0.0,>=0.7.1 in /usr/lib/python3/dist-packages (from boto3==1.34.0) (1.0.1)
Collecting s3transfer<0.10.0,>=0.9.0 (from boto3==1.34.0)
  Downloading https://archive1.piwheels.org/simple/s3transfer/s3transfer-0.9.0-py3-none-any.whl (82 kB)
Collecting gotrue<2.0.0,>=1.3.0 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/gotrue/gotrue-1.3.1-py3-none-any.whl (42 kB)
Collecting postgrest<0.14.0,>=0.10.8 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/postgrest/postgrest-0.13.2-py3-none-any.whl (19 kB)
Collecting realtime<2.0.0,>=1.0.0 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/realtime/realtime-1.0.6-py3-none-any.whl (9.0 kB)
Collecting storage3<0.7.0,>=0.5.3 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/storage3/storage3-0.6.1-py3-none-any.whl (15 kB)
Collecting supafunc<0.4.0,>=0.3.1 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/supafunc/supafunc-0.3.3-py3-none-any.whl (6.1 kB)
Requirement already satisfied: PiDNG in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (4.0.9)
Requirement already satisfied: piexif in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (1.1.3)
Collecting v4l2-python3 (from picamera2==0.3.12)
  Downloading https://www.piwheels.org/simple/v4l2-python3/v4l2_python3-0.3.5-py3-none-any.whl (22 kB)
Requirement already satisfied: python-prctl in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (1.8.1)
Collecting httptools>=0.5.0 (from uvicorn[standard]==0.24.0)
  Downloading httptools-0.6.4-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (3.6 kB)
Collecting pyyaml>=5.1 (from uvicorn[standard]==0.24.0)
  Downloading PyYAML-6.0.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (2.1 kB)
Collecting uvloop!=0.15.0,!=0.15.1,>=0.14.0 (from uvicorn[standard]==0.24.0)
  Downloading uvloop-0.21.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (4.9 kB)
Collecting watchfiles>=0.13 (from uvicorn[standard]==0.24.0)
  Downloading watchfiles-1.1.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (4.9 kB)
Requirement already satisfied: websockets>=10.4 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from uvicorn[standard]==0.24.0) (12.0)
Requirement already satisfied: certifi in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (2025.6.15)
Collecting httpcore<0.18.0,>=0.15.0 (from httpx<0.25.0,>=0.24.0)
  Downloading https://www.piwheels.org/simple/httpcore/httpcore-0.17.3-py3-none-any.whl (74 kB)
Requirement already satisfied: idna in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (3.10)
Requirement already satisfied: sniffio in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (1.3.1)
Requirement already satisfied: python-dateutil<3.0.0,>=2.1 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from botocore<1.35.0,>=1.34.0->boto3==1.34.0) (2.9.0.post0)
Requirement already satisfied: urllib3!=2.2.0,<3,>=1.25.4 in /usr/lib/python3/dist-packages (from botocore<1.35.0,>=1.34.0->boto3==1.34.0) (1.26.12)
Collecting h11>=0.8 (from uvicorn==0.24.0->uvicorn[standard]==0.24.0)
  Downloading https://www.piwheels.org/simple/h11/h11-0.14.0-py3-none-any.whl (58 kB)
Requirement already satisfied: deprecation<3.0.0,>=2.1.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (2.1.0)
Requirement already satisfied: strenum<0.5.0,>=0.4.9 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (0.4.15)
Requirement already satisfied: packaging in /home/michomanoly14892/.local/lib/python3.11/site-packages (from deprecation<3.0.0,>=2.1.0->postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (25.0)
Requirement already satisfied: annotated-types>=0.6.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (0.7.0)
Requirement already satisfied: pydantic-core==2.33.2 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (2.33.2)
Requirement already satisfied: typing-inspection>=0.4.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (0.4.1)
Requirement already satisfied: six>=1.5 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from python-dateutil<3.0.0,>=2.1->botocore<1.35.0,>=1.34.0->boto3==1.34.0) (1.17.0)
Downloading Pillow-10.1.0-cp311-cp311-manylinux_2_28_aarch64.whl (3.5 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 3.5/3.5 MB 3.8 MB/s  0:00:00
Downloading simplejpeg-1.6.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl (242 kB)
Downloading av-15.1.0-cp311-cp311-manylinux_2_28_aarch64.whl (38.1 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 38.1/38.1 MB 3.4 MB/s  0:00:11
Downloading httptools-0.6.4-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (462 kB)
Downloading PyYAML-6.0.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (736 kB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 736.8/736.8 kB 3.9 MB/s  0:00:00
Downloading uvloop-0.21.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (4.0 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 4.0/4.0 MB 3.4 MB/s  0:00:01
Downloading watchfiles-1.1.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (450 kB)
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: v4l2-python3, uvloop, simplejpeg, schedule, pyyaml, python-multipart, Pillow, httptools, h11, av, anyio, watchfiles, uvicorn, starlette, realtime, picamera2, httpcore, botocore, s3transfer, httpx, fastapi, supafunc, storage3, postgrest, gotrue, boto3, supabase
  Attempting uninstall: simplejpeg
    Found existing installation: simplejpeg 1.8.1
    Not uninstalling simplejpeg at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'simplejpeg'. No files were found to uninstall.
  Attempting uninstall: Pillow
    Found existing installation: Pillow 9.4.0
    Not uninstalling pillow at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'Pillow'. No files were found to uninstall.
  Attempting uninstall: h11
    Found existing installation: h11 0.16.0
    Not uninstalling h11 at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'h11'. No files were found to uninstall.
  Attempting uninstall: av
    Found existing installation: av 12.3.0
    Not uninstalling av at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'av'. No files were found to uninstall.
  Attempting uninstall: anyio
    Found existing installation: anyio 4.9.0
    Not uninstalling anyio at /home/michomanoly14892/.local/lib/python3.11/site-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'anyio'. No files were found to uninstall.
  Attempting uninstall: realtime
    Found existing installation: realtime 2.5.3
    Not uninstalling realtime at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'realtime'. No files were found to uninstall.
  Attempting uninstall: picamera2
    Found existing installation: picamera2 0.3.30
    Not uninstalling picamera2 at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'picamera2'. No files were found to uninstall.
  Attempting uninstall: httpcore
    Found existing installation: httpcore 1.0.9
    Not uninstalling httpcore at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'httpcore'. No files were found to uninstall.
  Attempting uninstall: botocore
    Found existing installation: botocore 1.29.27
    Not uninstalling botocore at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'botocore'. No files were found to uninstall.
  Attempting uninstall: s3transfer
    Found existing installation: s3transfer 0.6.0
    Not uninstalling s3transfer at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 's3transfer'. No files were found to uninstall.
  Attempting uninstall: httpx
    Found existing installation: httpx 0.28.1
    Not uninstalling httpx at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'httpx'. No files were found to uninstall.
  Attempting uninstall: supafunc
    Found existing installation: supafunc 0.10.1
    Not uninstalling supafunc at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'supafunc'. No files were found to uninstall.
  Attempting uninstall: storage3
    Found existing installation: storage3 0.12.0
    Not uninstalling storage3 at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'storage3'. No files were found to uninstall.
  Attempting uninstall: postgrest
    Found existing installation: postgrest 1.1.1
    Not uninstalling postgrest at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'postgrest'. No files were found to uninstall.
  Attempting uninstall: gotrue
    Found existing installation: gotrue 2.12.2
    Not uninstalling gotrue at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'gotrue'. No files were found to uninstall.
  Attempting uninstall: boto3
    Found existing installation: boto3 1.26.27
    Not uninstalling boto3 at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'boto3'. No files were found to uninstall.
  Attempting uninstall: supabase
    Found existing installation: supabase 2.16.0
    Not uninstalling supabase at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'supabase'. No files were found to uninstall.

Successfully installed Pillow-10.1.0 anyio-3.7.1 av-15.1.0 boto3-1.34.0 botocore-1.34.162 fastapi-0.104.1 gotrue-1.3.1 h11-0.14.0 httpcore-0.17.3 httptools-0.6.4 httpx-0.24.1 picamera2-0.3.12 postgrest-0.13.2 python-multipart-0.0.6 pyyaml-6.0.2 realtime-1.0.6 s3transfer-0.9.0 schedule-1.2.0 simplejpeg-1.6.6 starlette-0.27.0 storage3-0.6.1 supabase-2.0.2 supafunc-0.3.3 uvicorn-0.24.0 uvloop-0.21.0 v4l2-python3-0.3.5 watchfiles-1.1.0
[23:51:26] âœ… Core dependencies installed successfully
[23:51:26] Installing OpenCV stitching dependencies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: opencv-python>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (4.11.0.86)
Collecting opencv-contrib-python>=4.8.0
  Downloading opencv_contrib_python-4.12.0.88-cp37-abi3-manylinux2014_aarch64.manylinux_2_17_aarch64.whl.metadata (19 kB)
Requirement already satisfied: numpy>=1.21.2 in /usr/lib/python3/dist-packages (from opencv-python>=4.8.0) (1.24.2)
Collecting numpy>=1.21.2 (from opencv-python>=4.8.0)
  Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (63 kB)
Downloading opencv_contrib_python-4.12.0.88-cp37-abi3-manylinux2014_aarch64.manylinux_2_17_aarch64.whl (51.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 51.3/51.3 MB 3.3 MB/s  0:00:15
Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (14.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.3/14.3 MB 3.5 MB/s  0:00:04
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy, opencv-contrib-python
  Attempting uninstall: numpy
    Found existing installation: numpy 1.24.2
    Not uninstalling numpy at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'numpy'. No files were found to uninstall.

Successfully installed numpy-2.2.6 opencv-contrib-python-4.12.0.88
[23:51:52] âœ… OpenCV dependencies installed successfully
[23:51:52] ğŸ” Verifying backend virtual environment...
Python version: 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0]
[23:51:52] âœ… Virtual environment is valid
[23:51:52] ğŸ”§ Installing typing-extensions with fallback strategies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting typing-extensions>=4.12.0
  Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
WARNING: Error parsing dependencies of send2trash: Expected matching RIGHT_PARENTHESIS for LEFT_PARENTHESIS, after version specifier
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: typing-extensions
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.14.0
    Not uninstalling typing-extensions at /home/michomanoly14892/.local/lib/python3.11/site-packages, outside environment /opt/ezrec-backend/backend/venv
    Can't uninstall 'typing_extensions'. No files were found to uninstall.
Successfully installed typing-extensions-4.15.0
[23:51:56] âœ… typing-extensions installed successfully with version constraint
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting simplejpeg
  Downloading simplejpeg-1.8.2.tar.gz (5.5 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 5.5/5.5 MB 3.8 MB/s  0:00:01
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Collecting numpy>=1.19.3 (from simplejpeg)
  Downloading numpy-2.3.2-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl.metadata (62 kB)
Downloading numpy-2.3.2-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl (14.6 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.6/14.6 MB 4.0 MB/s  0:00:03
Building wheels for collected packages: simplejpeg
  Building wheel for simplejpeg (pyproject.toml): started
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): finished with status 'done'
  Created wheel for simplejpeg: filename=simplejpeg-1.8.2-cp311-cp311-linux_aarch64.whl size=442429 sha256=e640d07c0c01389386a6b3f7f27d1ca40ae69fa65affa8f9f3f07ee09bf78419
  Stored in directory: /tmp/pip-ephem-wheel-cache-oc113ll9/wheels/2a/4a/8b/5589c46335d8955dde48df4c3fd1370c51df6df06472dd2103
Successfully built simplejpeg
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy, simplejpeg
  Attempting uninstall: numpy
    Found existing installation: numpy 2.2.6
    Uninstalling numpy-2.2.6:
      Successfully uninstalled numpy-2.2.6
  Attempting uninstall: simplejpeg
    Found existing installation: simplejpeg 1.6.6
    Uninstalling simplejpeg-1.6.6:
      Successfully uninstalled simplejpeg-1.6.6

ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
opencv-contrib-python 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= "3.9", but you have numpy 2.3.2 which is incompatible.
Successfully installed numpy-2.3.2 simplejpeg-1.8.2
[23:55:59] Upgrading PyAV to ensure picamera2 compatibility
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: av>=15.0.0 in ./venv/lib/python3.11/site-packages (15.1.0)
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
[23:56:01] Installing OpenCV stitching dependencies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: opencv-python>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (4.11.0.86)
Requirement already satisfied: opencv-contrib-python>=4.8.0 in ./venv/lib/python3.11/site-packages (4.12.0.88)
Requirement already satisfied: numpy>=1.21.0 in ./venv/lib/python3.11/site-packages (2.3.2)
Collecting numpy>=1.21.0
  Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (63 kB)
Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (14.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.3/14.3 MB 3.9 MB/s  0:00:03
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy
  Attempting uninstall: numpy
    Found existing installation: numpy 2.3.2
    Uninstalling numpy-2.3.2:
      Successfully uninstalled numpy-2.3.2
Successfully installed numpy-2.2.6
[23:56:10] Verifying picamera2 and PyAV compatibility
âœ… picamera2 and PyAV compatibility verified
[23:56:10] âœ… picamera2 and PyAV compatibility verified
[23:56:10] Verifying OpenCV stitching compatibility
âœ… OpenCV stitching compatibility verified
[23:56:11] âœ… OpenCV stitching compatibility verified
[23:56:11] backend virtual environment ready
[23:56:11] Setting up API virtual environment
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: pip in ./venv/lib/python3.11/site-packages (23.0.1)
Collecting pip
  Downloading https://www.piwheels.org/simple/pip/pip-25.2-py3-none-any.whl (1.8 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 1.8/1.8 MB 1.7 MB/s eta 0:00:00
Installing collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 23.0.1
    Uninstalling pip-23.0.1:
      Successfully uninstalled pip-23.0.1
Successfully installed pip-25.2
[23:56:19] Installing dependencies with PyPI forcing for problematic packages...
[23:56:19] Installing dependencies with optimized conflict resolution...
[23:56:19] Installing core dependencies first...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting fastapi==0.104.1
  Downloading https://www.piwheels.org/simple/fastapi/fastapi-0.104.1-py3-none-any.whl (92 kB)
Collecting uvicorn==0.24.0 (from uvicorn[standard]==0.24.0)
  Downloading https://www.piwheels.org/simple/uvicorn/uvicorn-0.24.0-py3-none-any.whl (59 kB)
Collecting python-multipart==0.0.6
  Downloading https://www.piwheels.org/simple/python-multipart/python_multipart-0.0.6-py3-none-any.whl (45 kB)
Requirement already satisfied: python-dotenv==1.0.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (1.0.0)
Collecting boto3==1.34.0
  Downloading https://archive1.piwheels.org/simple/boto3/boto3-1.34.0-py3-none-any.whl (136 kB)
Collecting supabase==2.0.2
  Downloading https://archive1.piwheels.org/simple/supabase/supabase-2.0.2-py3-none-any.whl (11 kB)
Collecting httpx<0.25.0,>=0.24.0
  Downloading https://www.piwheels.org/simple/httpx/httpx-0.24.1-py3-none-any.whl (75 kB)
Collecting Pillow==10.1.0
  Downloading Pillow-10.1.0-cp311-cp311-manylinux_2_28_aarch64.whl.metadata (9.5 kB)
Collecting simplejpeg==1.6.6
  Downloading simplejpeg-1.6.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl.metadata (6.8 kB)
Collecting av>=15.0.0
  Downloading av-15.1.0-cp311-cp311-manylinux_2_28_aarch64.whl.metadata (4.6 kB)
Collecting picamera2==0.3.12
  Downloading https://www.piwheels.org/simple/picamera2/picamera2-0.3.12-py3-none-any.whl (62 kB)
Requirement already satisfied: numpy>=1.24.0 in /usr/lib/python3/dist-packages (1.24.2)
Requirement already satisfied: psutil>=5.9.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (5.9.5)
Collecting schedule==1.2.0
  Downloading https://www.piwheels.org/simple/schedule/schedule-1.2.0-py3-none-any.whl (11 kB)
Collecting anyio<4.0.0,>=3.7.1 (from fastapi==0.104.1)
  Downloading https://www.piwheels.org/simple/anyio/anyio-3.7.1-py3-none-any.whl (80 kB)
Requirement already satisfied: pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from fastapi==0.104.1) (2.11.7)
Collecting starlette<0.28.0,>=0.27.0 (from fastapi==0.104.1)
  Downloading https://www.piwheels.org/simple/starlette/starlette-0.27.0-py3-none-any.whl (66 kB)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from fastapi==0.104.1) (4.14.0)
Requirement already satisfied: click>=7.0 in /usr/lib/python3/dist-packages (from uvicorn==0.24.0->uvicorn[standard]==0.24.0) (8.1.3)
Requirement already satisfied: h11>=0.8 in /usr/local/lib/python3.11/dist-packages (from uvicorn==0.24.0->uvicorn[standard]==0.24.0) (0.16.0)
Collecting botocore<1.35.0,>=1.34.0 (from boto3==1.34.0)
  Downloading https://www.piwheels.org/simple/botocore/botocore-1.34.162-py3-none-any.whl (12.4 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 12.4/12.4 MB 3.3 MB/s  0:00:03
Requirement already satisfied: jmespath<2.0.0,>=0.7.1 in /usr/lib/python3/dist-packages (from boto3==1.34.0) (1.0.1)
Collecting s3transfer<0.10.0,>=0.9.0 (from boto3==1.34.0)
  Downloading https://archive1.piwheels.org/simple/s3transfer/s3transfer-0.9.0-py3-none-any.whl (82 kB)
Collecting gotrue<2.0.0,>=1.3.0 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/gotrue/gotrue-1.3.1-py3-none-any.whl (42 kB)
Collecting postgrest<0.14.0,>=0.10.8 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/postgrest/postgrest-0.13.2-py3-none-any.whl (19 kB)
Collecting realtime<2.0.0,>=1.0.0 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/realtime/realtime-1.0.6-py3-none-any.whl (9.0 kB)
Collecting storage3<0.7.0,>=0.5.3 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/storage3/storage3-0.6.1-py3-none-any.whl (15 kB)
Collecting supafunc<0.4.0,>=0.3.1 (from supabase==2.0.2)
  Downloading https://www.piwheels.org/simple/supafunc/supafunc-0.3.3-py3-none-any.whl (6.1 kB)
Requirement already satisfied: PiDNG in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (4.0.9)
Requirement already satisfied: piexif in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (1.1.3)
Collecting v4l2-python3 (from picamera2==0.3.12)
  Downloading https://www.piwheels.org/simple/v4l2-python3/v4l2_python3-0.3.5-py3-none-any.whl (22 kB)
Requirement already satisfied: python-prctl in /usr/lib/python3/dist-packages (from picamera2==0.3.12) (1.8.1)
Collecting httptools>=0.5.0 (from uvicorn[standard]==0.24.0)
  Downloading httptools-0.6.4-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (3.6 kB)
Collecting pyyaml>=5.1 (from uvicorn[standard]==0.24.0)
  Downloading PyYAML-6.0.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (2.1 kB)
Collecting uvloop!=0.15.0,!=0.15.1,>=0.14.0 (from uvicorn[standard]==0.24.0)
  Downloading uvloop-0.21.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (4.9 kB)
Collecting watchfiles>=0.13 (from uvicorn[standard]==0.24.0)
  Downloading watchfiles-1.1.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (4.9 kB)
Requirement already satisfied: websockets>=10.4 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from uvicorn[standard]==0.24.0) (12.0)
Requirement already satisfied: certifi in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (2025.6.15)
Collecting httpcore<0.18.0,>=0.15.0 (from httpx<0.25.0,>=0.24.0)
  Downloading https://www.piwheels.org/simple/httpcore/httpcore-0.17.3-py3-none-any.whl (74 kB)
Requirement already satisfied: idna in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (3.10)
Requirement already satisfied: sniffio in /home/michomanoly14892/.local/lib/python3.11/site-packages (from httpx<0.25.0,>=0.24.0) (1.3.1)
Requirement already satisfied: python-dateutil<3.0.0,>=2.1 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from botocore<1.35.0,>=1.34.0->boto3==1.34.0) (2.9.0.post0)
Requirement already satisfied: urllib3!=2.2.0,<3,>=1.25.4 in /usr/lib/python3/dist-packages (from botocore<1.35.0,>=1.34.0->boto3==1.34.0) (1.26.12)
Collecting h11>=0.8 (from uvicorn==0.24.0->uvicorn[standard]==0.24.0)
  Downloading https://www.piwheels.org/simple/h11/h11-0.14.0-py3-none-any.whl (58 kB)
Requirement already satisfied: deprecation<3.0.0,>=2.1.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (2.1.0)
Requirement already satisfied: strenum<0.5.0,>=0.4.9 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (0.4.15)
Requirement already satisfied: packaging in /home/michomanoly14892/.local/lib/python3.11/site-packages (from deprecation<3.0.0,>=2.1.0->postgrest<0.14.0,>=0.10.8->supabase==2.0.2) (25.0)
Requirement already satisfied: annotated-types>=0.6.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (0.7.0)
Requirement already satisfied: pydantic-core==2.33.2 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (2.33.2)
Requirement already satisfied: typing-inspection>=0.4.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.104.1) (0.4.1)
Requirement already satisfied: six>=1.5 in /home/michomanoly14892/.local/lib/python3.11/site-packages (from python-dateutil<3.0.0,>=2.1->botocore<1.35.0,>=1.34.0->boto3==1.34.0) (1.17.0)
Downloading Pillow-10.1.0-cp311-cp311-manylinux_2_28_aarch64.whl (3.5 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 3.5/3.5 MB 4.2 MB/s  0:00:00
Downloading simplejpeg-1.6.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl (242 kB)
Downloading av-15.1.0-cp311-cp311-manylinux_2_28_aarch64.whl (38.1 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 38.1/38.1 MB 4.2 MB/s  0:00:09
Downloading httptools-0.6.4-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (462 kB)
Downloading PyYAML-6.0.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (736 kB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 736.8/736.8 kB 4.0 MB/s  0:00:00
Downloading uvloop-0.21.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (4.0 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 4.0/4.0 MB 4.4 MB/s  0:00:00
Downloading watchfiles-1.1.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (450 kB)
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: v4l2-python3, uvloop, simplejpeg, schedule, pyyaml, python-multipart, Pillow, httptools, h11, av, anyio, watchfiles, uvicorn, starlette, realtime, picamera2, httpcore, botocore, s3transfer, httpx, fastapi, supafunc, storage3, postgrest, gotrue, boto3, supabase
  Attempting uninstall: simplejpeg
    Found existing installation: simplejpeg 1.8.1
    Not uninstalling simplejpeg at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'simplejpeg'. No files were found to uninstall.
  Attempting uninstall: Pillow
    Found existing installation: Pillow 9.4.0
    Not uninstalling pillow at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'Pillow'. No files were found to uninstall.
  Attempting uninstall: h11
    Found existing installation: h11 0.16.0
    Not uninstalling h11 at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'h11'. No files were found to uninstall.
  Attempting uninstall: av
    Found existing installation: av 12.3.0
    Not uninstalling av at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'av'. No files were found to uninstall.
  Attempting uninstall: anyio
    Found existing installation: anyio 4.9.0
    Not uninstalling anyio at /home/michomanoly14892/.local/lib/python3.11/site-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'anyio'. No files were found to uninstall.
  Attempting uninstall: realtime
    Found existing installation: realtime 2.5.3
    Not uninstalling realtime at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'realtime'. No files were found to uninstall.
  Attempting uninstall: picamera2
    Found existing installation: picamera2 0.3.30
    Not uninstalling picamera2 at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'picamera2'. No files were found to uninstall.
  Attempting uninstall: httpcore
    Found existing installation: httpcore 1.0.9
    Not uninstalling httpcore at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'httpcore'. No files were found to uninstall.
  Attempting uninstall: botocore
    Found existing installation: botocore 1.29.27
    Not uninstalling botocore at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'botocore'. No files were found to uninstall.
  Attempting uninstall: s3transfer
    Found existing installation: s3transfer 0.6.0
    Not uninstalling s3transfer at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 's3transfer'. No files were found to uninstall.
  Attempting uninstall: httpx
    Found existing installation: httpx 0.28.1
    Not uninstalling httpx at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'httpx'. No files were found to uninstall.
  Attempting uninstall: supafunc
    Found existing installation: supafunc 0.10.1
    Not uninstalling supafunc at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'supafunc'. No files were found to uninstall.
  Attempting uninstall: storage3
    Found existing installation: storage3 0.12.0
    Not uninstalling storage3 at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'storage3'. No files were found to uninstall.
  Attempting uninstall: postgrest
    Found existing installation: postgrest 1.1.1
    Not uninstalling postgrest at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'postgrest'. No files were found to uninstall.
  Attempting uninstall: gotrue
    Found existing installation: gotrue 2.12.2
    Not uninstalling gotrue at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'gotrue'. No files were found to uninstall.
  Attempting uninstall: boto3
    Found existing installation: boto3 1.26.27
    Not uninstalling boto3 at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'boto3'. No files were found to uninstall.
  Attempting uninstall: supabase
    Found existing installation: supabase 2.16.0
    Not uninstalling supabase at /usr/local/lib/python3.11/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'supabase'. No files were found to uninstall.

Successfully installed Pillow-10.1.0 anyio-3.7.1 av-15.1.0 boto3-1.34.0 botocore-1.34.162 fastapi-0.104.1 gotrue-1.3.1 h11-0.14.0 httpcore-0.17.3 httptools-0.6.4 httpx-0.24.1 picamera2-0.3.12 postgrest-0.13.2 python-multipart-0.0.6 pyyaml-6.0.2 realtime-1.0.6 s3transfer-0.9.0 schedule-1.2.0 simplejpeg-1.6.6 starlette-0.27.0 storage3-0.6.1 supabase-2.0.2 supafunc-0.3.3 uvicorn-0.24.0 uvloop-0.21.0 v4l2-python3-0.3.5 watchfiles-1.1.0
[23:56:54] âœ… Core dependencies installed successfully
[23:56:54] Installing OpenCV stitching dependencies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: opencv-python>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (4.11.0.86)
Collecting opencv-contrib-python>=4.8.0
  Downloading opencv_contrib_python-4.12.0.88-cp37-abi3-manylinux2014_aarch64.manylinux_2_17_aarch64.whl.metadata (19 kB)
Requirement already satisfied: numpy>=1.21.2 in /usr/lib/python3/dist-packages (from opencv-python>=4.8.0) (1.24.2)
Collecting numpy>=1.21.2 (from opencv-python>=4.8.0)
  Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (63 kB)
Downloading opencv_contrib_python-4.12.0.88-cp37-abi3-manylinux2014_aarch64.manylinux_2_17_aarch64.whl (51.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 51.3/51.3 MB 3.7 MB/s  0:00:13
Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (14.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.3/14.3 MB 4.0 MB/s  0:00:03
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy, opencv-contrib-python
  Attempting uninstall: numpy
    Found existing installation: numpy 1.24.2
    Not uninstalling numpy at /usr/lib/python3/dist-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'numpy'. No files were found to uninstall.

Successfully installed numpy-2.2.6 opencv-contrib-python-4.12.0.88
[23:57:18] âœ… OpenCV dependencies installed successfully
[23:57:18] ğŸ” Verifying API virtual environment...
Python version: 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0]
[23:57:18] âœ… Virtual environment is valid
[23:57:18] ğŸ”§ Installing typing-extensions with fallback strategies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting typing-extensions>=4.12.0
  Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
WARNING: Error parsing dependencies of send2trash: Expected matching RIGHT_PARENTHESIS for LEFT_PARENTHESIS, after version specifier
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: typing-extensions
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.14.0
    Not uninstalling typing-extensions at /home/michomanoly14892/.local/lib/python3.11/site-packages, outside environment /opt/ezrec-backend/api/venv
    Can't uninstall 'typing_extensions'. No files were found to uninstall.
Successfully installed typing-extensions-4.15.0
[23:57:21] âœ… typing-extensions installed successfully with version constraint
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Collecting simplejpeg
  Downloading simplejpeg-1.8.2.tar.gz (5.5 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 5.5/5.5 MB 4.0 MB/s  0:00:01
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Collecting numpy>=1.19.3 (from simplejpeg)
  Downloading numpy-2.3.2-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl.metadata (62 kB)
Downloading numpy-2.3.2-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl (14.6 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.6/14.6 MB 3.5 MB/s  0:00:04
Building wheels for collected packages: simplejpeg
  Building wheel for simplejpeg (pyproject.toml): started
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): still running...
  Building wheel for simplejpeg (pyproject.toml): finished with status 'done'
  Created wheel for simplejpeg: filename=simplejpeg-1.8.2-cp311-cp311-linux_aarch64.whl size=442432 sha256=58c6b545f82c40087ced78a77285cc07bea393d70dcaf244c35dc89227c5a287
  Stored in directory: /tmp/pip-ephem-wheel-cache-_a8huq5v/wheels/2a/4a/8b/5589c46335d8955dde48df4c3fd1370c51df6df06472dd2103
Successfully built simplejpeg
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy, simplejpeg
  Attempting uninstall: numpy
    Found existing installation: numpy 2.2.6
    Uninstalling numpy-2.2.6:
      Successfully uninstalled numpy-2.2.6
  Attempting uninstall: simplejpeg
    Found existing installation: simplejpeg 1.6.6
    Uninstalling simplejpeg-1.6.6:
      Successfully uninstalled simplejpeg-1.6.6

ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
opencv-contrib-python 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= "3.9", but you have numpy 2.3.2 which is incompatible.
Successfully installed numpy-2.3.2 simplejpeg-1.8.2
[00:01:24] Upgrading PyAV to ensure picamera2 compatibility
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: av>=15.0.0 in ./venv/lib/python3.11/site-packages (15.1.0)
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
[00:01:26] Installing OpenCV stitching dependencies...
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: opencv-python>=4.8.0 in /home/michomanoly14892/.local/lib/python3.11/site-packages (4.11.0.86)
Requirement already satisfied: opencv-contrib-python>=4.8.0 in ./venv/lib/python3.11/site-packages (4.12.0.88)
Requirement already satisfied: numpy>=1.21.0 in ./venv/lib/python3.11/site-packages (2.3.2)
Collecting numpy>=1.21.0
  Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl.metadata (63 kB)
Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (14.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.3/14.3 MB 3.9 MB/s  0:00:03
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
Installing collected packages: numpy
  Attempting uninstall: numpy
    Found existing installation: numpy 2.3.2
    Uninstalling numpy-2.3.2:
      Successfully uninstalled numpy-2.3.2
Successfully installed numpy-2.2.6
[00:01:35] Verifying picamera2 and PyAV compatibility
âœ… picamera2 and PyAV compatibility verified
[00:01:35] âœ… picamera2 and PyAV compatibility verified
[00:01:35] Verifying OpenCV stitching compatibility
âœ… OpenCV stitching compatibility verified
[00:01:36] âœ… OpenCV stitching compatibility verified
[00:01:36] API virtual environment ready
[00:01:36] STEP: 7. Applying fixes
[00:01:36] Creating improved kms.py placeholder for picamera2 compatibility
[00:01:36] Improved kms.py placeholder created
[00:01:36] Deploying working video_worker with all fixes...
[00:01:36] âœ… video_worker.py exists and will be used
[00:01:36] Setting up assets directory
[00:01:36] Starting asset download with timeout protection...
[00:01:36] Checking and downloading user assets (smart mode)
[00:01:36] Current directory: /opt/ezrec-backend
[00:01:36] Checking if .env exists: -rwxr-xr-x 1 michomanoly14892 michomanoly14892 2672 Aug 30 23:50 .env
[00:01:39] âœ… Asset check/download completed successfully
[00:01:39] Smart asset download process completed
[00:01:39] âœ… Asset download completed
[00:01:39] STEP: Setting up files and permissions
touch: cannot touch '/opt/ezrec-backend/logs/system_status.log': Permission denied
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ 