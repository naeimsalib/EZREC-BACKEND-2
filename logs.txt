# EZREC System Logs - Fresh Start
# This file contains system check output and deployment logs
# Generated automatically by the deployment script

# =============================================================================
# SYSTEM CHECK OUTPUT
# =============================================================================
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ sudo journalctl -u ezrec-api.service --no-pager -l -n 50
Sep 14 16:55:06 raspberrypi uvicorn[563456]: INFO:     Waiting for application shutdown.
Sep 14 16:55:06 raspberrypi uvicorn[563456]: INFO:     Application shutdown complete.
Sep 14 16:55:07 raspberrypi systemd[1]: ezrec-api.service: Main process exited, code=exited, status=1/FAILURE
Sep 14 16:55:07 raspberrypi systemd[1]: ezrec-api.service: Failed with result 'exit-code'.
Sep 14 16:55:07 raspberrypi systemd[1]: ezrec-api.service: Consumed 1.497s CPU time.
Sep 14 16:55:12 raspberrypi systemd[1]: ezrec-api.service: Scheduled restart job, restart counter is at 133.
Sep 14 16:55:12 raspberrypi systemd[1]: Stopped ezrec-api.service - EZREC FastAPI Backend.
Sep 14 16:55:12 raspberrypi systemd[1]: ezrec-api.service: Consumed 1.497s CPU time.
Sep 14 16:55:12 raspberrypi systemd[1]: Started ezrec-api.service - EZREC FastAPI Backend.
Sep 14 16:55:13 raspberrypi uvicorn[563473]: 2025-09-14 16:55:13,080 [INFO] ‚úÖ Supabase client initialized successfully
Sep 14 16:55:13 raspberrypi uvicorn[563473]: 2025-09-14 16:55:13,081 [INFO] ‚úÖ Using camera ID: d217e751-dfa5-5276-abbb-da5ad6c2626a
Sep 14 16:55:13 raspberrypi uvicorn[563473]: INFO:     Started server process [563473]
Sep 14 16:55:13 raspberrypi uvicorn[563473]: INFO:     Waiting for application startup.
Sep 14 16:55:13 raspberrypi uvicorn[563473]: INFO:     Application startup complete.
Sep 14 16:55:13 raspberrypi uvicorn[563473]: ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
Sep 14 16:55:13 raspberrypi uvicorn[563473]: INFO:     Waiting for application shutdown.
Sep 14 16:55:13 raspberrypi uvicorn[563473]: INFO:     Application shutdown complete.
Sep 14 16:55:13 raspberrypi systemd[1]: ezrec-api.service: Main process exited, code=exited, status=1/FAILURE
Sep 14 16:55:13 raspberrypi systemd[1]: ezrec-api.service: Failed with result 'exit-code'.
Sep 14 16:55:13 raspberrypi systemd[1]: ezrec-api.service: Consumed 1.449s CPU time.
Sep 14 16:55:18 raspberrypi systemd[1]: ezrec-api.service: Scheduled restart job, restart counter is at 134.
Sep 14 16:55:18 raspberrypi systemd[1]: Stopped ezrec-api.service - EZREC FastAPI Backend.
Sep 14 16:55:18 raspberrypi systemd[1]: ezrec-api.service: Consumed 1.449s CPU time.
Sep 14 16:55:18 raspberrypi systemd[1]: Started ezrec-api.service - EZREC FastAPI Backend.
Sep 14 16:55:19 raspberrypi uvicorn[563490]: 2025-09-14 16:55:19,590 [INFO] ‚úÖ Supabase client initialized successfully
Sep 14 16:55:19 raspberrypi uvicorn[563490]: 2025-09-14 16:55:19,591 [INFO] ‚úÖ Using camera ID: d217e751-dfa5-5276-abbb-da5ad6c2626a
Sep 14 16:55:19 raspberrypi uvicorn[563490]: INFO:     Started server process [563490]
Sep 14 16:55:19 raspberrypi uvicorn[563490]: INFO:     Waiting for application startup.
Sep 14 16:55:19 raspberrypi uvicorn[563490]: INFO:     Application startup complete.
Sep 14 16:55:19 raspberrypi uvicorn[563490]: ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
Sep 14 16:55:19 raspberrypi uvicorn[563490]: INFO:     Waiting for application shutdown.
Sep 14 16:55:19 raspberrypi uvicorn[563490]: INFO:     Application shutdown complete.
Sep 14 16:55:20 raspberrypi systemd[1]: ezrec-api.service: Main process exited, code=exited, status=1/FAILURE
Sep 14 16:55:20 raspberrypi systemd[1]: ezrec-api.service: Failed with result 'exit-code'.
Sep 14 16:55:20 raspberrypi systemd[1]: ezrec-api.service: Consumed 1.497s CPU time.
Sep 14 16:55:25 raspberrypi systemd[1]: ezrec-api.service: Scheduled restart job, restart counter is at 135.
Sep 14 16:55:25 raspberrypi systemd[1]: Stopped ezrec-api.service - EZREC FastAPI Backend.
Sep 14 16:55:25 raspberrypi systemd[1]: ezrec-api.service: Consumed 1.497s CPU time.
Sep 14 16:55:25 raspberrypi systemd[1]: Started ezrec-api.service - EZREC FastAPI Backend.
Sep 14 16:55:26 raspberrypi uvicorn[563507]: 2025-09-14 16:55:26,033 [INFO] ‚úÖ Supabase client initialized successfully
Sep 14 16:55:26 raspberrypi uvicorn[563507]: 2025-09-14 16:55:26,033 [INFO] ‚úÖ Using camera ID: d217e751-dfa5-5276-abbb-da5ad6c2626a
Sep 14 16:55:26 raspberrypi uvicorn[563507]: INFO:     Started server process [563507]
Sep 14 16:55:26 raspberrypi uvicorn[563507]: INFO:     Waiting for application startup.
Sep 14 16:55:26 raspberrypi uvicorn[563507]: INFO:     Application startup complete.
Sep 14 16:55:26 raspberrypi uvicorn[563507]: ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
Sep 14 16:55:26 raspberrypi uvicorn[563507]: INFO:     Waiting for application shutdown.
Sep 14 16:55:26 raspberrypi uvicorn[563507]: INFO:     Application shutdown complete.
Sep 14 16:55:26 raspberrypi systemd[1]: ezrec-api.service: Main process exited, code=exited, status=1/FAILURE
Sep 14 16:55:26 raspberrypi systemd[1]: ezrec-api.service: Failed with result 'exit-code'.
Sep 14 16:55:26 raspberrypi systemd[1]: ezrec-api.service: Consumed 1.464s CPU time.
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ sudo systemctl status ezrec-api.service --no-pager -l
‚óè ezrec-api.service - EZREC FastAPI Backend
     Loaded: loaded (/etc/systemd/system/ezrec-api.service; enabled; preset: enabled)
     Active: activating (auto-restart) (Result: exit-code) since Sun 2025-09-14 16:55:32 EDT; 4s ago
    Process: 563527 ExecStart=/opt/ezrec-backend/api/venv/bin/uvicorn api_server:app --host 0.0.0.0 --port 8000 (code=exited, status=1/FAILURE)
   Main PID: 563527 (code=exited, status=1/FAILURE)
        CPU: 1.459s
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ ls -la /opt/ezrec-backend/api/
ls -la /opt/ezrec-backend/api/venv/bin/uvicorn
ls -la /opt/ezrec-backend/api/api_server.py
total 132
drwxr-xr-x  7 michomanoly14892 michomanoly14892  4096 Sep  1 16:07 .
drwxr-xr-x 19 michomanoly14892 michomanoly14892  4096 Sep  1 15:39 ..
-rwxr-xr-x  1 michomanoly14892 michomanoly14892 47792 Sep  1 16:07 api_server.py
-rwxr-xr-x  1 root             root             47774 Sep  1 15:40 api_server.py.backup
-rwxr-xr-x  1 michomanoly14892 michomanoly14892  3873 Sep  1 15:29 booking_utils.py
drwxr-xr-x  2 michomanoly14892 michomanoly14892  4096 Sep  1 15:56 local_data
-rwxr-xr-x  1 michomanoly14892 michomanoly14892   717 Sep  1 15:29 monitor.py
drwxr-xr-x  2 michomanoly14892 michomanoly14892  4096 Sep  1 16:07 __pycache__
drwxr-xr-x  4 michomanoly14892 michomanoly14892  4096 Sep  1 15:40 stitch
drwxr-xr-x  2 michomanoly14892 michomanoly14892  4096 Sep  1 15:29 templates
drwxr-xr-x  5 michomanoly14892 michomanoly14892  4096 Sep  1 15:34 venv
-rwxr-xr-x 1 michomanoly14892 michomanoly14892 207 Sep  1 15:35 /opt/ezrec-backend/api/venv/bin/uvicorn
-rwxr-xr-x 1 michomanoly14892 michomanoly14892 47792 Sep  1 16:07 /opt/ezrec-backend/api/api_server.py
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ 
michomanoly14892@raspberrypi:~/EZREC-BACKEND-2 $ cd /opt/ezrec-backend/api
/opt/ezrec-backend/api/venv/bin/python3 -c "import api_server; print('API imports OK')"
2025-09-14 16:55:55,964 [INFO] ‚úÖ Supabase client initialized successfully
2025-09-14 16:55:55,965 [INFO] ‚úÖ Using camera ID: d217e751-dfa5-5276-abbb-da5ad6c2626a
API imports OK
michomanoly14892@raspberrypi:/opt/ezrec-backend/api $ sudo netstat -tlnp | grep :8000
sudo lsof -i :8000
tcp        0      0 0.0.0.0:8000            0.0.0.0:*               LISTEN      560999/python3      
COMMAND    PID             USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
python3 560999 michomanoly14892   13u  IPv4 3660995      0t0  TCP *:8000 (LISTEN)
michomanoly14892@raspberrypi:/opt/ezrec-backend/api $ [0;32m[17:01:58] Starting EZREC deployment as user: root[0m
[0;34m[17:01:58] STEP: 1. Applying comprehensive system fixes[0m
[0;32m[17:01:58] üîß Fixing port conflicts with comprehensive cleanup...[0m
[0;32m[17:01:58] üõë Stopping all EZREC services...[0m
[0;32m[17:01:59] üßπ Comprehensive port cleanup...[0m
[0;32m[17:01:59] üßπ Killing processes by name...[0m
[0;32m[17:02:02] ‚úÖ Port 8000 is now free[0m
[0;32m[17:02:02] ‚úÖ Port 9000 is now free[0m
[0;32m[17:02:02] ‚úÖ Comprehensive port conflict resolution completed[0m
[0;32m[17:02:02] üîß Installing psutil in all virtual environments...[0m
[0;32m[17:02:02] üì¶ Installing psutil in backend virtual environment...[0m
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: psutil in /home/michomanoly14892/.local/lib/python3.11/site-packages (5.9.5)
WARNING: Error parsing dependencies of send2trash: Expected matching RIGHT_PARENTHESIS for LEFT_PARENTHESIS, after version specifier
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
[0;32m[17:02:04] ‚úÖ psutil installed successfully in backend venv[0m
[0;32m[17:02:04] üì¶ Installing psutil in API virtual environment...[0m
Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple
Requirement already satisfied: psutil in /home/michomanoly14892/.local/lib/python3.11/site-packages (5.9.5)
WARNING: Error parsing dependencies of send2trash: Expected matching RIGHT_PARENTHESIS for LEFT_PARENTHESIS, after version specifier
    sys-platform (=="darwin") ; extra == 'objc'
                 ~^
[0;32m[17:02:05] ‚úÖ psutil installed successfully in API venv[0m
[0;32m[17:02:05] üß™ Testing psutil imports...[0m
‚úÖ psutil imported successfully in backend
[0;32m[17:02:05] ‚úÖ psutil import test passed in backend[0m
‚úÖ psutil imported successfully in API
[0;32m[17:02:05] ‚úÖ psutil import test passed in API[0m
[0;32m[17:02:05] ‚úÖ psutil installed and tested successfully in all environments[0m
[0;32m[17:02:05] üîß Ensuring all required files and directories exist...[0m
[0;32m[17:02:05] üìÅ Creating logs directory...[0m
[0;32m[17:02:05] ‚úÖ Logs directory created with proper permissions[0m
[0;32m[17:02:05] üìÑ Creating system_status.log file...[0m
[0;32m[17:02:05] ‚úÖ system_status.log file created with proper permissions[0m
[0;32m[17:02:05] üìÑ Copying system_status.py to deployment directory...[0m
[0;32m[17:02:05] ‚úÖ system_status.py copied with proper permissions[0m
[0;32m[17:02:05] ‚úÖ All required files and directories created with proper permissions[0m
[0;32m[17:02:05] üîß Ensuring all services are properly enabled...[0m
[0;32m[17:02:05] üîß Enabling dual_recorder.service for auto-start...[0m
[0;32m[17:02:06] ‚úÖ dual_recorder.service enabled successfully[0m
[0;32m[17:02:06] üîß Enabling video_worker.service for auto-start...[0m
[0;32m[17:02:06] ‚úÖ video_worker.service enabled successfully[0m
[0;32m[17:02:06] üîß Enabling ezrec-api.service for auto-start...[0m
[0;32m[17:02:06] ‚úÖ ezrec-api.service enabled successfully[0m
[0;32m[17:02:06] üîß Enabling system_status.service for auto-start...[0m
[0;32m[17:02:06] ‚úÖ system_status.service enabled successfully[0m
[0;32m[17:02:06] üîß Enabling system_status.timer for auto-start...[0m
[0;32m[17:02:06] ‚úÖ system_status.timer enabled successfully[0m
[0;32m[17:02:06] üîç Verifying services are enabled...[0m
[0;32m[17:02:06] ‚úÖ dual_recorder.service is enabled[0m
[0;32m[17:02:06] ‚úÖ video_worker.service is enabled[0m
[0;32m[17:02:06] ‚úÖ ezrec-api.service is enabled[0m
[0;32m[17:02:07] ‚úÖ system_status.service is enabled[0m
[0;32m[17:02:07] ‚úÖ All services properly enabled for auto-start[0m
[0;34m[17:02:07] STEP: 2. Starting all services safely[0m
[0;32m[17:02:07] üîß Starting all services safely with port conflict prevention...[0m
[0;32m[17:02:07] üîß Fixing port conflicts with comprehensive cleanup...[0m
[0;32m[17:02:07] üõë Stopping all EZREC services...[0m
[0;32m[17:02:07] üßπ Comprehensive port cleanup...[0m
[0;32m[17:02:07] üîç Found processes on port 8000, killing them...[0m
[0;32m[17:02:09] üßπ Killing processes by name...[0m
[0;32m[17:02:12] ‚úÖ Port 8000 is now free[0m
[0;32m[17:02:12] ‚úÖ Port 9000 is now free[0m
[0;32m[17:02:12] ‚úÖ Comprehensive port conflict resolution completed[0m
[0;32m[17:02:12] üöÄ Starting ezrec-api.service...[0m
[0;32m[17:02:12] üîß Special handling for API service...[0m
[0;32m[17:02:12] ‚úÖ ezrec-api.service started successfully[0m
[0;32m[17:02:12] ‚è≥ Waiting for API service to be ready...[0m
[0;32m[17:02:22] ‚úÖ API service is responding[0m
[0;32m[17:02:25] üöÄ Starting dual_recorder.service...[0m
[0;32m[17:02:25] ‚úÖ dual_recorder.service started successfully[0m
[0;32m[17:02:25] ‚è≥ Waiting longer for dual_recorder to fully initialize...[0m
[0;32m[17:02:35] üöÄ Starting video_worker.service...[0m
[0;32m[17:02:35] ‚úÖ video_worker.service started successfully[0m
[0;32m[17:02:35] ‚è≥ Waiting longer for video_worker to fully initialize...[0m
[0;32m[17:02:45] üöÄ Starting system_status.service...[0m
[0;32m[17:02:45] üîß Special handling for system_status service...[0m
[0;32m[17:02:45] ‚úÖ system_status.log file exists and is writable[0m
[0;32m[17:02:48] ‚úÖ system_status.service started successfully[0m
[0;32m[17:02:51] üöÄ Starting system_status.timer...[0m
[0;32m[17:02:51] ‚úÖ system_status.timer started successfully[0m
[0;32m[17:02:51] ‚úÖ All services started safely[0m
[0;32m[17:02:51] ‚è≥ Waiting for all services to fully initialize...[0m
[0;34m[17:03:06] STEP: 3. Verifying system completely[0m
[0;32m[17:03:06] üîç Performing comprehensive system verification...[0m
[0;32m[17:03:06] üß™ Checking all services are running...[0m
[0;32m[17:03:06] ‚úÖ dual_recorder.service is running[0m
[0;32m[17:03:06] ‚è≥ video_worker.service not ready yet, retrying in 5s... (attempt 1/3)[0m
[0;32m[17:03:11] ‚è≥ video_worker.service not ready yet, retrying in 5s... (attempt 2/3)[0m
[0;32m[17:03:16] ‚úÖ video_worker.service is running[0m
[0;32m[17:03:16] ‚è≥ ezrec-api.service not ready yet, retrying in 5s... (attempt 1/3)[0m
[0;32m[17:03:21] ‚è≥ ezrec-api.service not ready yet, retrying in 5s... (attempt 2/3)[0m
[0;31m[17:03:26] ERROR: ‚ùå ezrec-api.service is not running after 3 attempts[0m
[0;32m[17:03:26] üìã Service status:[0m
‚óè ezrec-api.service - EZREC FastAPI Backend
     Loaded: loaded (/etc/systemd/system/ezrec-api.service; enabled; preset: enabled)
     Active: activating (auto-restart) (Result: exit-code) since Sun 2025-09-14 17:03:24 EDT; 1s ago
    Process: 565301 ExecStart=/opt/ezrec-backend/api/venv/bin/uvicorn api_server:app --host 0.0.0.0 --port 8000 (code=exited, status=1/FAILURE)
   Main PID: 565301 (code=exited, status=1/FAILURE)
        CPU: 1.516s

Sep 14 17:03:24 raspberrypi systemd[1]: ezrec-api.service: Consumed 1.516s CPU time.
